module.exports=function(t){var e={};function i(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=6)}([function(t,e,i){(function(t){var i,r=function(t){"use strict";var e=1e7,i=7,n=9007199254740992,s=y(n),o="0123456789abcdefghijklmnopqrstuvwxyz",u="function"==typeof BigInt;function l(t,e,i,r){return void 0===t?l[0]:void 0!==e&&(10!=+e||i)?j(t,e,i,r):Y(t)}function a(t,e){this.value=t,this.sign=e,this.isSmall=!1}function h(t){this.value=t,this.sign=t<0,this.isSmall=!0}function p(t){this.value=t}function c(t){return-n<t&&t<n}function y(t){return t<1e7?[t]:t<1e14?[t%1e7,Math.floor(t/1e7)]:[t%1e7,Math.floor(t/1e7)%1e7,Math.floor(t/1e14)]}function d(t){f(t);var i=t.length;if(i<4&&B(t,s)<0)switch(i){case 0:return 0;case 1:return t[0];case 2:return t[0]+t[1]*e;default:return t[0]+(t[1]+t[2]*e)*e}return t}function f(t){for(var e=t.length;0===t[--e];);t.length=e+1}function m(t){for(var e=new Array(t),i=-1;++i<t;)e[i]=0;return e}function b(t){return t>0?Math.floor(t):Math.ceil(t)}function v(t,i){var r,n,s=t.length,o=i.length,u=new Array(s),l=0,a=e;for(n=0;n<o;n++)l=(r=t[n]+i[n]+l)>=a?1:0,u[n]=r-l*a;for(;n<s;)l=(r=t[n]+l)===a?1:0,u[n++]=r-l*a;return l>0&&u.push(l),u}function g(t,e){return t.length>=e.length?v(t,e):v(e,t)}function w(t,i){var r,n,s=t.length,o=new Array(s),u=e;for(n=0;n<s;n++)r=t[n]-u+i,i=Math.floor(r/u),o[n]=r-i*u,i+=1;for(;i>0;)o[n++]=i%u,i=Math.floor(i/u);return o}function E(t,i){var r,n,s=t.length,o=i.length,u=new Array(s),l=0,a=e;for(r=0;r<o;r++)(n=t[r]-l-i[r])<0?(n+=a,l=1):l=0,u[r]=n;for(r=o;r<s;r++){if(!((n=t[r]-l)<0)){u[r++]=n;break}n+=a,u[r]=n}for(;r<s;r++)u[r]=t[r];return f(u),u}function q(t,i,r){var n,s,o=t.length,u=new Array(o),l=-i,p=e;for(n=0;n<o;n++)s=t[n]+l,l=Math.floor(s/p),s%=p,u[n]=s<0?s+p:s;return"number"==typeof(u=d(u))?(r&&(u=-u),new h(u)):new a(u,r)}function z(t,i){var r,n,s,o,u=t.length,l=i.length,a=m(u+l),h=e;for(s=0;s<u;++s){o=t[s];for(var p=0;p<l;++p)r=o*i[p]+a[s+p],n=Math.floor(r/h),a[s+p]=r-n*h,a[s+p+1]+=n}return f(a),a}function S(t,i){var r,n,s=t.length,o=new Array(s),u=e,l=0;for(n=0;n<s;n++)r=t[n]*i+l,l=Math.floor(r/u),o[n]=r-l*u;for(;l>0;)o[n++]=l%u,l=Math.floor(l/u);return o}function x(t,e){for(var i=[];e-- >0;)i.push(0);return i.concat(t)}function _(t,i,r){return new a(t<e?S(i,t):z(i,y(t)),r)}function N(t){var i,r,n,s,o=t.length,u=m(o+o),l=e;for(n=0;n<o;n++){r=0-(s=t[n])*s;for(var a=n;a<o;a++)i=s*t[a]*2+u[n+a]+r,r=Math.floor(i/l),u[n+a]=i-r*l;u[n+o]=r}return f(u),u}function I(t,i){var r,n,s,o,u=t.length,l=m(u),a=e;for(s=0,r=u-1;r>=0;--r)s=(o=s*a+t[r])-(n=b(o/i))*i,l[r]=0|n;return[l,0|s]}function O(t,i){var r,n=Y(i);if(u)return[new p(t.value/n.value),new p(t.value%n.value)];var s,o=t.value,c=n.value;if(0===c)throw new Error("Cannot divide by zero");if(t.isSmall)return n.isSmall?[new h(b(o/c)),new h(o%c)]:[l[0],t];if(n.isSmall){if(1===c)return[t,l[0]];if(-1==c)return[t.negate(),l[0]];var v=Math.abs(c);if(v<e){s=d((r=I(o,v))[0]);var g=r[1];return t.sign&&(g=-g),"number"==typeof s?(t.sign!==n.sign&&(s=-s),[new h(s),new h(g)]):[new a(s,t.sign!==n.sign),new h(g)]}c=y(v)}var w=B(o,c);if(-1===w)return[l[0],t];if(0===w)return[l[t.sign===n.sign?1:-1],l[0]];s=(r=o.length+c.length<=200?function(t,i){var r,n,s,o,u,l,a,h=t.length,p=i.length,c=e,y=m(i.length),f=i[p-1],b=Math.ceil(c/(2*f)),v=S(t,b),g=S(i,b);for(v.length<=h&&v.push(0),g.push(0),f=g[p-1],n=h-p;n>=0;n--){for(r=c-1,v[n+p]!==f&&(r=Math.floor((v[n+p]*c+v[n+p-1])/f)),s=0,o=0,l=g.length,u=0;u<l;u++)s+=r*g[u],a=Math.floor(s/c),o+=v[n+u]-(s-a*c),s=a,o<0?(v[n+u]=o+c,o=-1):(v[n+u]=o,o=0);for(;0!==o;){for(r-=1,s=0,u=0;u<l;u++)(s+=v[n+u]-c+g[u])<0?(v[n+u]=s+c,s=0):(v[n+u]=s,s=1);o+=s}y[n]=r}return v=I(v,b)[0],[d(y),d(v)]}(o,c):function(t,i){for(var r,n,s,o,u,l=t.length,a=i.length,h=[],p=[],c=e;l;)if(p.unshift(t[--l]),f(p),B(p,i)<0)h.push(0);else{s=p[(n=p.length)-1]*c+p[n-2],o=i[a-1]*c+i[a-2],n>a&&(s=(s+1)*c),r=Math.ceil(s/o);do{if(B(u=S(i,r),p)<=0)break;r--}while(r);h.push(r),p=E(p,u)}return h.reverse(),[d(h),d(p)]}(o,c))[0];var q=t.sign!==n.sign,z=r[1],x=t.sign;return"number"==typeof s?(q&&(s=-s),s=new h(s)):s=new a(s,q),"number"==typeof z?(x&&(z=-z),z=new h(z)):z=new a(z,x),[s,z]}function B(t,e){if(t.length!==e.length)return t.length>e.length?1:-1;for(var i=t.length-1;i>=0;i--)if(t[i]!==e[i])return t[i]>e[i]?1:-1;return 0}function P(t){var e=t.abs();return!e.isUnit()&&(!!(e.equals(2)||e.equals(3)||e.equals(5))||!(e.isEven()||e.isDivisibleBy(3)||e.isDivisibleBy(5))&&(!!e.lesser(49)||void 0))}function A(t,e){for(var i,n,s,o=t.prev(),u=o,l=0;u.isEven();)u=u.divide(2),l++;t:for(n=0;n<e.length;n++)if(!t.lesser(e[n])&&!(s=r(e[n]).modPow(u,t)).isUnit()&&!s.equals(o)){for(i=l-1;0!=i;i--){if((s=s.square().mod(t)).isUnit())return!1;if(s.equals(o))continue t}return!1}return!0}a.prototype=Object.create(l.prototype),h.prototype=Object.create(l.prototype),p.prototype=Object.create(l.prototype),a.prototype.add=function(t){var e=Y(t);if(this.sign!==e.sign)return this.subtract(e.negate());var i=this.value,r=e.value;return e.isSmall?new a(w(i,Math.abs(r)),this.sign):new a(g(i,r),this.sign)},a.prototype.plus=a.prototype.add,h.prototype.add=function(t){var e=Y(t),i=this.value;if(i<0!==e.sign)return this.subtract(e.negate());var r=e.value;if(e.isSmall){if(c(i+r))return new h(i+r);r=y(Math.abs(r))}return new a(w(r,Math.abs(i)),i<0)},h.prototype.plus=h.prototype.add,p.prototype.add=function(t){return new p(this.value+Y(t).value)},p.prototype.plus=p.prototype.add,a.prototype.subtract=function(t){var e=Y(t);if(this.sign!==e.sign)return this.add(e.negate());var i=this.value,r=e.value;return e.isSmall?q(i,Math.abs(r),this.sign):function(t,e,i){var r;return B(t,e)>=0?r=E(t,e):(r=E(e,t),i=!i),"number"==typeof(r=d(r))?(i&&(r=-r),new h(r)):new a(r,i)}(i,r,this.sign)},a.prototype.minus=a.prototype.subtract,h.prototype.subtract=function(t){var e=Y(t),i=this.value;if(i<0!==e.sign)return this.add(e.negate());var r=e.value;return e.isSmall?new h(i-r):q(r,Math.abs(i),i>=0)},h.prototype.minus=h.prototype.subtract,p.prototype.subtract=function(t){return new p(this.value-Y(t).value)},p.prototype.minus=p.prototype.subtract,a.prototype.negate=function(){return new a(this.value,!this.sign)},h.prototype.negate=function(){var t=this.sign,e=new h(-this.value);return e.sign=!t,e},p.prototype.negate=function(){return new p(-this.value)},a.prototype.abs=function(){return new a(this.value,!1)},h.prototype.abs=function(){return new h(Math.abs(this.value))},p.prototype.abs=function(){return new p(this.value>=0?this.value:-this.value)},a.prototype.multiply=function(t){var i,r,n,s=Y(t),o=this.value,u=s.value,h=this.sign!==s.sign;if(s.isSmall){if(0===u)return l[0];if(1===u)return this;if(-1===u)return this.negate();if((i=Math.abs(u))<e)return new a(S(o,i),h);u=y(i)}return r=o.length,n=u.length,new a(-.012*r-.012*n+15e-6*r*n>0?function t(e,i){var r=Math.max(e.length,i.length);if(r<=30)return z(e,i);r=Math.ceil(r/2);var n=e.slice(r),s=e.slice(0,r),o=i.slice(r),u=i.slice(0,r),l=t(s,u),a=t(n,o),h=t(g(s,n),g(u,o)),p=g(g(l,x(E(E(h,l),a),r)),x(a,2*r));return f(p),p}(o,u):z(o,u),h)},a.prototype.times=a.prototype.multiply,h.prototype._multiplyBySmall=function(t){return c(t.value*this.value)?new h(t.value*this.value):_(Math.abs(t.value),y(Math.abs(this.value)),this.sign!==t.sign)},a.prototype._multiplyBySmall=function(t){return 0===t.value?l[0]:1===t.value?this:-1===t.value?this.negate():_(Math.abs(t.value),this.value,this.sign!==t.sign)},h.prototype.multiply=function(t){return Y(t)._multiplyBySmall(this)},h.prototype.times=h.prototype.multiply,p.prototype.multiply=function(t){return new p(this.value*Y(t).value)},p.prototype.times=p.prototype.multiply,a.prototype.square=function(){return new a(N(this.value),!1)},h.prototype.square=function(){var t=this.value*this.value;return c(t)?new h(t):new a(N(y(Math.abs(this.value))),!1)},p.prototype.square=function(t){return new p(this.value*this.value)},a.prototype.divmod=function(t){var e=O(this,t);return{quotient:e[0],remainder:e[1]}},p.prototype.divmod=h.prototype.divmod=a.prototype.divmod,a.prototype.divide=function(t){return O(this,t)[0]},p.prototype.over=p.prototype.divide=function(t){return new p(this.value/Y(t).value)},h.prototype.over=h.prototype.divide=a.prototype.over=a.prototype.divide,a.prototype.mod=function(t){return O(this,t)[1]},p.prototype.mod=p.prototype.remainder=function(t){return new p(this.value%Y(t).value)},h.prototype.remainder=h.prototype.mod=a.prototype.remainder=a.prototype.mod,a.prototype.pow=function(t){var e,i,r,n=Y(t),s=this.value,o=n.value;if(0===o)return l[1];if(0===s)return l[0];if(1===s)return l[1];if(-1===s)return n.isEven()?l[1]:l[-1];if(n.sign)return l[0];if(!n.isSmall)throw new Error("The exponent "+n.toString()+" is too large.");if(this.isSmall&&c(e=Math.pow(s,o)))return new h(b(e));for(i=this,r=l[1];!0&o&&(r=r.times(i),--o),0!==o;)o/=2,i=i.square();return r},h.prototype.pow=a.prototype.pow,p.prototype.pow=function(t){var e=Y(t),i=this.value,r=e.value,n=BigInt(0),s=BigInt(1),o=BigInt(2);if(r===n)return l[1];if(i===n)return l[0];if(i===s)return l[1];if(i===BigInt(-1))return e.isEven()?l[1]:l[-1];if(e.isNegative())return new p(n);for(var u=this,a=l[1];(r&s)===s&&(a=a.times(u),--r),r!==n;)r/=o,u=u.square();return a},a.prototype.modPow=function(t,e){if(t=Y(t),(e=Y(e)).isZero())throw new Error("Cannot take modPow with modulus 0");for(var i=l[1],r=this.mod(e);t.isPositive();){if(r.isZero())return l[0];t.isOdd()&&(i=i.multiply(r).mod(e)),t=t.divide(2),r=r.square().mod(e)}return i},p.prototype.modPow=h.prototype.modPow=a.prototype.modPow,a.prototype.compareAbs=function(t){var e=Y(t),i=this.value,r=e.value;return e.isSmall?1:B(i,r)},h.prototype.compareAbs=function(t){var e=Y(t),i=Math.abs(this.value),r=e.value;return e.isSmall?i===(r=Math.abs(r))?0:i>r?1:-1:-1},p.prototype.compareAbs=function(t){var e=this.value,i=Y(t).value;return(e=e>=0?e:-e)===(i=i>=0?i:-i)?0:e>i?1:-1},a.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=Y(t),i=this.value,r=e.value;return this.sign!==e.sign?e.sign?1:-1:e.isSmall?this.sign?-1:1:B(i,r)*(this.sign?-1:1)},a.prototype.compareTo=a.prototype.compare,h.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=Y(t),i=this.value,r=e.value;return e.isSmall?i==r?0:i>r?1:-1:i<0!==e.sign?i<0?-1:1:i<0?1:-1},h.prototype.compareTo=h.prototype.compare,p.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=this.value,i=Y(t).value;return e===i?0:e>i?1:-1},p.prototype.compareTo=p.prototype.compare,a.prototype.equals=function(t){return 0===this.compare(t)},p.prototype.eq=p.prototype.equals=h.prototype.eq=h.prototype.equals=a.prototype.eq=a.prototype.equals,a.prototype.notEquals=function(t){return 0!==this.compare(t)},p.prototype.neq=p.prototype.notEquals=h.prototype.neq=h.prototype.notEquals=a.prototype.neq=a.prototype.notEquals,a.prototype.greater=function(t){return this.compare(t)>0},p.prototype.gt=p.prototype.greater=h.prototype.gt=h.prototype.greater=a.prototype.gt=a.prototype.greater,a.prototype.lesser=function(t){return this.compare(t)<0},p.prototype.lt=p.prototype.lesser=h.prototype.lt=h.prototype.lesser=a.prototype.lt=a.prototype.lesser,a.prototype.greaterOrEquals=function(t){return this.compare(t)>=0},p.prototype.geq=p.prototype.greaterOrEquals=h.prototype.geq=h.prototype.greaterOrEquals=a.prototype.geq=a.prototype.greaterOrEquals,a.prototype.lesserOrEquals=function(t){return this.compare(t)<=0},p.prototype.leq=p.prototype.lesserOrEquals=h.prototype.leq=h.prototype.lesserOrEquals=a.prototype.leq=a.prototype.lesserOrEquals,a.prototype.isEven=function(){return 0==(1&this.value[0])},h.prototype.isEven=function(){return 0==(1&this.value)},p.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},a.prototype.isOdd=function(){return 1==(1&this.value[0])},h.prototype.isOdd=function(){return 1==(1&this.value)},p.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},a.prototype.isPositive=function(){return!this.sign},h.prototype.isPositive=function(){return this.value>0},p.prototype.isPositive=h.prototype.isPositive,a.prototype.isNegative=function(){return this.sign},h.prototype.isNegative=function(){return this.value<0},p.prototype.isNegative=h.prototype.isNegative,a.prototype.isUnit=function(){return!1},h.prototype.isUnit=function(){return 1===Math.abs(this.value)},p.prototype.isUnit=function(){return this.abs().value===BigInt(1)},a.prototype.isZero=function(){return!1},h.prototype.isZero=function(){return 0===this.value},p.prototype.isZero=function(){return this.value===BigInt(0)},a.prototype.isDivisibleBy=function(t){var e=Y(t);return!e.isZero()&&(!!e.isUnit()||(0===e.compareAbs(2)?this.isEven():this.mod(e).isZero()))},p.prototype.isDivisibleBy=h.prototype.isDivisibleBy=a.prototype.isDivisibleBy,a.prototype.isPrime=function(t){var e=P(this);if(void 0!==e)return e;var i=this.abs(),n=i.bitLength();if(n<=64)return A(i,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var s=Math.log(2)*n.toJSNumber(),o=Math.ceil(!0===t?2*Math.pow(s,2):s),u=[],l=0;l<o;l++)u.push(r(l+2));return A(i,u)},p.prototype.isPrime=h.prototype.isPrime=a.prototype.isPrime,a.prototype.isProbablePrime=function(t){var e=P(this);if(void 0!==e)return e;for(var i=this.abs(),n=void 0===t?5:t,s=[],o=0;o<n;o++)s.push(r.randBetween(2,i.minus(2)));return A(i,s)},p.prototype.isProbablePrime=h.prototype.isProbablePrime=a.prototype.isProbablePrime,a.prototype.modInv=function(t){for(var e,i,n,s=r.zero,o=r.one,u=Y(t),l=this.abs();!l.isZero();)e=u.divide(l),i=s,n=u,s=o,u=l,o=i.subtract(e.multiply(o)),l=n.subtract(e.multiply(l));if(!u.isUnit())throw new Error(this.toString()+" and "+t.toString()+" are not co-prime");return-1===s.compare(0)&&(s=s.add(t)),this.isNegative()?s.negate():s},p.prototype.modInv=h.prototype.modInv=a.prototype.modInv,a.prototype.next=function(){var t=this.value;return this.sign?q(t,1,this.sign):new a(w(t,1),this.sign)},h.prototype.next=function(){var t=this.value;return t+1<n?new h(t+1):new a(s,!1)},p.prototype.next=function(){return new p(this.value+BigInt(1))},a.prototype.prev=function(){var t=this.value;return this.sign?new a(w(t,1),!0):q(t,1,this.sign)},h.prototype.prev=function(){var t=this.value;return t-1>-n?new h(t-1):new a(s,!0)},p.prototype.prev=function(){return new p(this.value-BigInt(1))};for(var M=[1];2*M[M.length-1]<=e;)M.push(2*M[M.length-1]);var R=M.length,Z=M[R-1];function F(t){return Math.abs(t)<=e}function T(t,e,i){e=Y(e);for(var n=t.isNegative(),s=e.isNegative(),o=n?t.not():t,u=s?e.not():e,l=0,a=0,h=null,p=null,c=[];!o.isZero()||!u.isZero();)l=(h=O(o,Z))[1].toJSNumber(),n&&(l=Z-1-l),a=(p=O(u,Z))[1].toJSNumber(),s&&(a=Z-1-a),o=h[0],u=p[0],c.push(i(l,a));for(var y=0!==i(n?1:0,s?1:0)?r(-1):r(0),d=c.length-1;d>=0;d-=1)y=y.multiply(Z).add(r(c[d]));return y}a.prototype.shiftLeft=function(t){var e=Y(t).toJSNumber();if(!F(e))throw new Error(String(e)+" is too large for shifting.");if(e<0)return this.shiftRight(-e);var i=this;if(i.isZero())return i;for(;e>=R;)i=i.multiply(Z),e-=R-1;return i.multiply(M[e])},p.prototype.shiftLeft=h.prototype.shiftLeft=a.prototype.shiftLeft,a.prototype.shiftRight=function(t){var e,i=Y(t).toJSNumber();if(!F(i))throw new Error(String(i)+" is too large for shifting.");if(i<0)return this.shiftLeft(-i);for(var r=this;i>=R;){if(r.isZero()||r.isNegative()&&r.isUnit())return r;r=(e=O(r,Z))[1].isNegative()?e[0].prev():e[0],i-=R-1}return(e=O(r,M[i]))[1].isNegative()?e[0].prev():e[0]},p.prototype.shiftRight=h.prototype.shiftRight=a.prototype.shiftRight,a.prototype.not=function(){return this.negate().prev()},p.prototype.not=h.prototype.not=a.prototype.not,a.prototype.and=function(t){return T(this,t,function(t,e){return t&e})},p.prototype.and=h.prototype.and=a.prototype.and,a.prototype.or=function(t){return T(this,t,function(t,e){return t|e})},p.prototype.or=h.prototype.or=a.prototype.or,a.prototype.xor=function(t){return T(this,t,function(t,e){return t^e})},p.prototype.xor=h.prototype.xor=a.prototype.xor;var L=1<<30,U=(e&-e)*(e&-e)|L;function V(t){var i=t.value,r="number"==typeof i?i|L:"bigint"==typeof i?i|BigInt(L):i[0]+i[1]*e|U;return r&-r}function C(t,e){return t=Y(t),e=Y(e),t.greater(e)?t:e}function D(t,e){return t=Y(t),e=Y(e),t.lesser(e)?t:e}function G(t,e){if(t=Y(t).abs(),e=Y(e).abs(),t.equals(e))return t;if(t.isZero())return e;if(e.isZero())return t;for(var i,r,n=l[1];t.isEven()&&e.isEven();)i=D(V(t),V(e)),t=t.divide(i),e=e.divide(i),n=n.multiply(i);for(;t.isEven();)t=t.divide(V(t));do{for(;e.isEven();)e=e.divide(V(e));t.greater(e)&&(r=e,e=t,t=r),e=e.subtract(t)}while(!e.isZero());return n.isUnit()?t:t.multiply(n)}a.prototype.bitLength=function(){var t=this;return t.compareTo(r(0))<0&&(t=t.negate().subtract(r(1))),0===t.compareTo(r(0))?r(0):r(function t(e,i){if(i.compareTo(e)<=0){var n=t(e,i.square(i)),s=n.p,o=n.e,u=s.multiply(i);return u.compareTo(e)<=0?{p:u,e:2*o+1}:{p:s,e:2*o}}return{p:r(1),e:0}}(t,r(2)).e).add(r(1))},p.prototype.bitLength=h.prototype.bitLength=a.prototype.bitLength;var j=function(t,e,i,r){i=i||o,t=String(t),r||(t=t.toLowerCase(),i=i.toLowerCase());var n,s=t.length,u=Math.abs(e),l={};for(n=0;n<i.length;n++)l[i[n]]=n;for(n=0;n<s;n++){if("-"!==(p=t[n])&&(p in l&&l[p]>=u)){if("1"===p&&1===u)continue;throw new Error(p+" is not a valid digit in base "+e+".")}}e=Y(e);var a=[],h="-"===t[0];for(n=h?1:0;n<t.length;n++){var p;if((p=t[n])in l)a.push(Y(l[p]));else{if("<"!==p)throw new Error(p+" is not a valid character");var c=n;do{n++}while(">"!==t[n]&&n<t.length);a.push(Y(t.slice(c+1,n)))}}return J(a,e,h)};function J(t,e,i){var r,n=l[0],s=l[1];for(r=t.length-1;r>=0;r--)n=n.add(t[r].times(s)),s=s.times(e);return i?n.negate():n}function W(t,e){if((e=r(e)).isZero()){if(t.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(e.equals(-1)){if(t.isZero())return{value:[0],isNegative:!1};if(t.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-t.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var i=Array.apply(null,Array(t.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return i.unshift([1]),{value:[].concat.apply([],i),isNegative:!1}}var n=!1;if(t.isNegative()&&e.isPositive()&&(n=!0,t=t.abs()),e.isUnit())return t.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(t.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:n};for(var s,o=[],u=t;u.isNegative()||u.compareAbs(e)>=0;){s=u.divmod(e),u=s.quotient;var l=s.remainder;l.isNegative()&&(l=e.minus(l).abs(),u=u.next()),o.push(l.toJSNumber())}return o.push(u.toJSNumber()),{value:o.reverse(),isNegative:n}}function k(t,e,i){var r=W(t,e);return(r.isNegative?"-":"")+r.value.map(function(t){return function(t,e){return t<(e=e||o).length?e[t]:"<"+t+">"}(t,i)}).join("")}function X(t){if(c(+t)){var e=+t;if(e===b(e))return u?new p(BigInt(e)):new h(e);throw new Error("Invalid integer: "+t)}var r="-"===t[0];r&&(t=t.slice(1));var n=t.split(/e/i);if(n.length>2)throw new Error("Invalid integer: "+n.join("e"));if(2===n.length){var s=n[1];if("+"===s[0]&&(s=s.slice(1)),(s=+s)!==b(s)||!c(s))throw new Error("Invalid integer: "+s+" is not a valid exponent.");var o=n[0],l=o.indexOf(".");if(l>=0&&(s-=o.length-l-1,o=o.slice(0,l)+o.slice(l+1)),s<0)throw new Error("Cannot include negative exponent part for integers");t=o+=new Array(s+1).join("0")}if(!/^([0-9][0-9]*)$/.test(t))throw new Error("Invalid integer: "+t);if(u)return new p(BigInt(r?"-"+t:t));for(var y=[],d=t.length,m=i,v=d-m;d>0;)y.push(+t.slice(v,d)),(v-=m)<0&&(v=0),d-=m;return f(y),new a(y,r)}function Y(t){return"number"==typeof t?function(t){if(u)return new p(BigInt(t));if(c(t)){if(t!==b(t))throw new Error(t+" is not an integer.");return new h(t)}return X(t.toString())}(t):"string"==typeof t?X(t):"bigint"==typeof t?new p(t):t}a.prototype.toArray=function(t){return W(this,t)},h.prototype.toArray=function(t){return W(this,t)},p.prototype.toArray=function(t){return W(this,t)},a.prototype.toString=function(t,e){if(void 0===t&&(t=10),10!==t)return k(this,t,e);for(var i,r=this.value,n=r.length,s=String(r[--n]);--n>=0;)i=String(r[n]),s+="0000000".slice(i.length)+i;return(this.sign?"-":"")+s},h.prototype.toString=function(t,e){return void 0===t&&(t=10),10!=t?k(this,t,e):String(this.value)},p.prototype.toString=h.prototype.toString,p.prototype.toJSON=a.prototype.toJSON=h.prototype.toJSON=function(){return this.toString()},a.prototype.valueOf=function(){return parseInt(this.toString(),10)},a.prototype.toJSNumber=a.prototype.valueOf,h.prototype.valueOf=function(){return this.value},h.prototype.toJSNumber=h.prototype.valueOf,p.prototype.valueOf=p.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};for(var H=0;H<1e3;H++)l[H]=Y(H),H>0&&(l[-H]=Y(-H));return l.one=l[1],l.zero=l[0],l.minusOne=l[-1],l.max=C,l.min=D,l.gcd=G,l.lcm=function(t,e){return t=Y(t).abs(),e=Y(e).abs(),t.divide(G(t,e)).multiply(e)},l.isInstance=function(t){return t instanceof a||t instanceof h||t instanceof p},l.randBetween=function(t,i){var r=D(t=Y(t),i=Y(i)),n=C(t,i).subtract(r).add(1);if(n.isSmall)return r.add(Math.floor(Math.random()*n));for(var s=W(n,e).value,o=[],u=!0,a=0;a<s.length;a++){var h=u?s[a]:e,p=b(Math.random()*h);o.push(p),p<h&&(u=!1)}return r.add(l.fromArray(o,e,!1))},l.fromArray=function(t,e,i){return J(t.map(Y),Y(e||10),i)},l}();t.hasOwnProperty("exports")&&(t.exports=r),void 0===(i=function(){return r}.apply(e,[]))||(t.exports=i)}).call(this,i(9)(t))},function(t,e,i){const r=i(0);t.exports=class{static construct(t,e){return"number"==typeof t?r.randBetween(r.zero,r(2).pow(t)):("string"==typeof t?("number"==typeof e&&(this.n=r(t,e)),this.n=r(t)):this.n=t,this.n)}static mod(t,e){return t<0?t.mod(e).add(e):t.mod(e)}static toByteArray(t){let e=t.toArray(256).value;for(let t in e)e[t]>128&&(e[t]=-256+e[t]);return e}static signum(t){return t.isZero()?0:t.isNegative()?-1:1}static testBit(t,e){return!t.and(r.one.shiftLeft(e)).isZero()}}},function(t,e,i){"use strict";const r=i(3),n=i(0),s=i(1),o=n("1"),u=n("2"),l=n("0"),h=n("7");class p{static get p(){return n("21888242871839275222246405745257275088696311157297823662689037894645226208583")}static get n(){return n("21888242871839275222246405745257275088548364400416034343698204186575808495617")}}class c{static get _0(){return new c(n.zero)}static get _1(){return new c(n.one)}static get NON_RESIDUE(){return new c(n("21888242871839275222246405745257275088696311157297823662689037894645226208582"))}static get _2_INV(){return new c(n("10944121435919637611123202872628637544348155578648911831344518947322613104292"))}constructor(t){this.v=t}add(t){return new c(s.mod(this.v.add(t.v),p.p))}multiply(t){return t instanceof y?new y(t.a.multiply(this),t.b.multiply(this)):new c(s.mod(this.v.multiply(t.v),p.p))}subtract(t){return new c(s.mod(this.v.subtract(t.v),p.p))}square(){return new c(s.mod(this.v.multiply(this.v),p.p))}double(){return new c(s.mod(this.v.add(this.v),p.p))}inverse(){return new c(this.v.modInv(p.p))}divide(t){let e=t.inverse();return new c(s.mod(this.v.multiply(e.v),p.p))}negate(){return new c(this.v.negate().mod(p.p))}isZero(){return 0==this.v.compareTo(n.zero)}exp(t){let e=this;for(let i=t.bitLength()-2;i>=0;i--)e=e.square(),s.testBit(t,i)&&(e=e.multiply(this));return e}bytes(){return s.toByteArray(this.v)}eq(t){return 0==this.v.compareTo(t.v)}toString(){return this.v.toString()}}class y{static get _0(){return new y(c._0,c._0)}static get _1(){return new y(c._1,c._0)}static get NON_RESIDUE(){return new y(n(9),n.one)}static get FROBENIUS_COEFFS_B(){let t=new Array(2);return t[0]=new c(n.one),t[1]=new c(n("21888242871839275222246405745257275088696311157297823662689037894645226208582")),t}constructor(t,e){t instanceof c&&e instanceof c&&(this.a=t,this.b=e),n.isInstance(t)&&n.isInstance(e)&&(this.a=new c(t),this.b=new c(e))}square(){let t=this.a.multiply(this.b),e=this.a.add(this.b).multiply(this.b.multiply(c.NON_RESIDUE).add(this.a)).subtract(t).subtract(t.multiply(c.NON_RESIDUE)),i=t.double();return new y(e,i)}multiply(t){let e=this.a.multiply(t.a),i=this.b.multiply(t.b),r=i.multiply(c.NON_RESIDUE).add(e),n=this.a.add(this.b).multiply(t.a.add(t.b)).subtract(e).subtract(i);return new y(r,n)}divide(t){let e=t.inverse();return this.multiply(e)}add(t){return new y(this.a.add(t.a),this.b.add(t.b))}subtract(t){return new y(this.a.subtract(t.a),this.b.subtract(t.b))}double(){return this.add(this)}inverse(){let t=this.a.square(),e=this.b.square(),i=t.subtract(c.NON_RESIDUE.multiply(e)).inverse(),r=this.a.multiply(i),n=this.b.multiply(i).negate();return new y(r,n)}negate(){return new y(this.a.negate(),this.b.negate())}isZero(){return this.eq(y._0)}eq(t){if(!t instanceof y)return!1;let e=t;return!(null!=this.a?!this.a.eq(e.a):null!=e.a)&&!(null!=this.b?!this.b.eq(e.b):null!=e.b)}frobeniusMap(t){let e=this.a,i=y.FROBENIUS_COEFFS_B[t.mod(n(2))].multiply(this.b);return new y(e,i)}mulByNonResidue(){return y.NON_RESIDUE.multiply(this)}exp(t){let e=this;for(let i=t.bitLength()-2;i>=0;i--)e=e.square(),s.testBit(t,i)&&(e=e.multiply(this));return e}toString(){return this.a.toString()+", "+this.b.toString()}}class d{static get _0(){return new d(y._0,y._0,y._0)}static get _1(){return new d(y._1,y._0,y._0)}static get NON_RESIDUE(){return new y(n(9),n.one)}constructor(t,e,i){this.a=t,this.b=e,this.c=i}toString(){return"["+this.a.toString()+", "+this.b.toString()+", "+this.c.toString()+"]"}square(){let t=this.a.square(),e=this.a.multiply(this.b).double(),i=this.a.subtract(this.b).add(this.c).square(),r=this.b.multiply(this.c).double(),n=this.c.square(),s=t.add(r.mulByNonResidue()),o=e.add(n.mulByNonResidue()),u=e.add(i).add(r).subtract(t).subtract(n);return new d(s,o,u)}double(){return this.add(this)}multiply(t){if(t instanceof d){let e=this.a,i=this.b,r=this.c,n=t.a,s=t.b,o=t.c,u=e.multiply(n),l=i.multiply(s),a=r.multiply(o),h=u.add(i.add(r).multiply(s.add(o)).subtract(l).subtract(a).mulByNonResidue()),p=e.add(i).multiply(n.add(s)).subtract(u).subtract(l).add(a.mulByNonResidue()),c=e.add(r).multiply(n.add(o)).subtract(u).add(l).subtract(a);return new d(h,p,c)}if(t instanceof y){let e=this.a.multiply(t),i=this.b.multiply(t),r=this.c.multiply(t);return new d(e,i,r)}}mulByNonResidue(){let t=d.NON_RESIDUE.multiply(this.c),e=this.a,i=this.b;return new d(t,e,i)}add(t){let e=this.a.add(t.a),i=this.b.add(t.b),r=this.c.add(t.c);return new d(e,i,r)}subtract(t){let e=this.a.subtract(t.a),i=this.b.subtract(t.b),r=this.c.subtract(t.c);return new d(e,i,r)}inverse(){let t=this.a.square(),e=this.b.square(),i=this.c.square(),r=this.a.multiply(this.b),n=this.a.multiply(this.c),s=this.b.multiply(this.c),o=t.subtract(s.mulByNonResidue()),u=i.mulByNonResidue().subtract(r),l=e.subtract(n),a=this.a.multiply(o).add(this.c.multiply(u).add(this.b.multiply(l)).mulByNonResidue()).inverse(),h=a.multiply(o),p=a.multiply(u),c=a.multiply(l);return new d(h,p,c)}negate(){return new d(this.a.negate(),this.b.negate(),this.c.negate())}isZero(){return this.eq(this.ZERO)}frobeniusMap(t){let e=this.a.frobeniusMap(t),i=d.FROBENIUS_COEFFS_B()[t.mod(6).toJSNumber()].multiply(this.b.frobeniusMap(t)),r=d.FROBENIUS_COEFFS_C()[t.mod(6).toJSNumber()].multiply(this.c.frobeniusMap(t));return new d(e,i,r)}eq(t){if(!(t instanceof d))return!1;let e=t;return!(null!=this.a?!this.a.eq(e.a):null!=e.a)&&(!(null!=this.b?!this.b.eq(e.b):null!=e.b)&&!(null!=this.c?!this.c.eq(e.c):null!=e.c))}divide(t){let e=t.inverse();return this.multiply(e)}exp(t){let e=this;for(let i=t.bitLength()-2;i>=0;i--)e=e.square(),s.testBit(t,i)&&(e=e.multiply(this));return e}static FROBENIUS_COEFFS_B(){let t=[];return t.push(y._1),t.push(new y(n("21575463638280843010398324269430826099269044274347216827212613867836435027261"),n("10307601595873709700152284273816112264069230130616436755625194854815875713954"))),t.push(new y(n("21888242871839275220042445260109153167277707414472061641714758635765020556616"),n.zero)),t.push(new y(n("3772000881919853776433695186713858239009073593817195771773381919316419345261"),n("2236595495967245188281701248203181795121068902605861227855261137820944008926"))),t.push(new y(n("2203960485148121921418603742825762020974279258880205651966"),n.zero)),t.push(new y(n("18429021223477853657660792034369865839114504446431234726392080002137598044644"),n("9344045779998320333812420223237981029506012124075525679208581902008406485703"))),t}static FROBENIUS_COEFFS_C(){let t=[];return t[0]=y._1,t[1]=new y(n("2581911344467009335267311115468803099551665605076196740867805258568234346338"),n("19937756971775647987995932169929341994314640652964949448313374472400716661030")),t[2]=new y(n("2203960485148121921418603742825762020974279258880205651966"),n.zero),t[3]=new y(n("5324479202449903542726783395506214481928257762400643279780343368557297135718"),n("16208900380737693084919495127334387981393726419856888799917914180988844123039")),t[4]=new y(n("21888242871839275220042445260109153167277707414472061641714758635765020556616"),n.zero),t[5]=new y(n("13981852324922362344252311234282257507216387789820983642040889267519694726527"),n("7629828391165209371577384193250820201684255241773809077146787135900891633097")),t}}class f{static get _0(){return new f(d._0,d._0)}static get _1(){return new f(d._1,d._0)}constructor(t,e){this.a=t,this.b=e}square(){let t=this.a.multiply(this.b),e=this.a.add(this.b).multiply(this.a.add(this.b.mulByNonResidue())).subtract(t).subtract(t.mulByNonResidue()),i=t.add(t);return new f(e,i)}double(){return null}mulBy024(t,e,i){let r,n,s,o,u,l,a,h,p,c,y=this.a.a,m=this.a.b,b=this.a.c,v=this.b.a,g=this.b.b,w=this.b.c,E=t,q=i,z=e;return a=y.multiply(E),h=b.multiply(q),p=g.multiply(z),s=y.add(g),n=y.add(b),o=m.add(v).add(w),u=(c=m.multiply(q)).add(p),y=l=d.NON_RESIDUE.multiply(u).add(a),u=w.multiply(z),c=c.add(u),u=u.add(h),l=d.NON_RESIDUE.multiply(u),u=m.multiply(E),c=c.add(u),m=l=l.add(u),r=E.add(q),u=n.multiply(r).subtract(a).subtract(h),l=v.multiply(z),c=c.add(l),u=u.add(l),r=b.add(g),b=u,n=q.add(z),u=r.multiply(n).subtract(h).subtract(p),l=d.NON_RESIDUE.multiply(u),u=v.multiply(E),c=c.add(u),v=l=l.add(u),u=w.multiply(q),c=c.add(u),l=d.NON_RESIDUE.multiply(u),r=E.add(z),u=s.multiply(r).subtract(a).subtract(p),g=l=l.add(u),r=E.add(q).add(z),w=u=o.multiply(r).subtract(c),new f(new d(y,m,b),new d(v,g,w))}add(t){return new f(this.a.add(t.a),this.b.add(t.b))}divide(t){let e=t.inverse();return this.multiply(e)}multiply(t){let e=t.a,i=t.b,r=this.a,n=this.b,s=r.multiply(e),o=n.multiply(i),u=s.add(o.mulByNonResidue()),l=r.add(n).multiply(e.add(i)).subtract(s).subtract(o);return new f(u,l)}subtract(t){return new f(this.a.subtract(t.a),this.b.subtract(t.b))}inverse(){let t=this.a.square(),e=this.b.square(),i=t.subtract(e.mulByNonResidue()).inverse(),r=this.a.multiply(i),n=this.b.multiply(i).negate();return new f(r,n)}negate(){return new f(a.negate(),b.negate())}isZero(){return this.eq(f._0)}frobeniusMap(t){let e=this.a.frobeniusMap(t),i=this.b.frobeniusMap(t).multiply(f.FROBENIUS_COEFFS_B[t.mod(12)]);return new f(e,i)}cyclotomicSquared(){let t,e,i,r,n,s,o,u=this.a.a,l=this.a.b,a=this.a.c,h=this.b.a,p=this.b.b,c=this.b.c;return o=u.multiply(p),t=u.add(p).multiply(u.add(d.NON_RESIDUE.multiply(p))).subtract(o).subtract(d.NON_RESIDUE.multiply(o)),e=o.add(o),o=h.multiply(a),i=h.add(a).multiply(h.add(d.NON_RESIDUE.multiply(a))).subtract(o).subtract(d.NON_RESIDUE.multiply(o)),r=o.add(o),o=l.multiply(c),n=l.add(c).multiply(l.add(d.NON_RESIDUE.multiply(c))).subtract(o).subtract(d.NON_RESIDUE.multiply(o)),s=o.add(o),u=(u=(u=t.subtract(u)).add(u)).add(t),p=(p=(p=e.add(p)).add(p)).add(e),h=(h=(h=(o=d.NON_RESIDUE.multiply(s)).add(h)).add(h)).add(o),a=(a=(a=n.subtract(a)).add(a)).add(n),l=(l=(l=i.subtract(l)).add(l)).add(i),c=(c=(c=r.add(c)).add(c)).add(r),new f(new d(u,l,a),new d(h,p,c))}cyclotomicExp(t){let e=f._1;for(let i=t.bitLength()-1;i>=0;i--)e=e.cyclotomicSquared(),s.testBit(t,i)&&(e=e.multiply(this));return e}unitaryInverse(){let t=this.a,e=this.b.negate();return new f(t,e)}negExp(t){return this.cyclotomicExp(t).unitaryInverse()}eq(t){if(this==t)return!0;if(!(t instanceof f))return!1;let e=t;return!(null!=this.a?!this.a.eq(e.a):null!=e.a)&&!(null!=this.b?!this.b.eq(e.b):null!=e.b)}toString(){return"["+this.a.toString()+" "+this.b.toString()+"]"}static get FROBENIUS_COEFFS_B(){let t=new Array(12);return t[0]=new y(n.one,n.zero),t[1]=new y(n("8376118865763821496583973867626364092589906065868298776909617916018768340080"),n("16469823323077808223889137241176536799009286646108169935659301613961712198316")),t[2]=new y(n("21888242871839275220042445260109153167277707414472061641714758635765020556617"),n.zero),t[3]=new y(n("11697423496358154304825782922584725312912383441159505038794027105778954184319"),n("303847389135065887422783454877609941456349188919719272345083954437860409601")),t[4]=new y(n("21888242871839275220042445260109153167277707414472061641714758635765020556616"),n.zero),t[5]=new y(n("3321304630594332808241809054958361220322477375291206261884409189760185844239"),n("5722266937896532885780051958958348231143373700109372999374820235121374419868")),t[6]=new y(n("21888242871839275222246405745257275088696311157297823662689037894645226208582"),n.zero),t[7]=new y(n("13512124006075453725662431877630910996106405091429524885779419978626457868503"),n("5418419548761466998357268504080738289687024511189653727029736280683514010267")),t[8]=new y(n("2203960485148121921418603742825762020974279258880205651966"),n.zero),t[9]=new y(n("10190819375481120917420622822672549775783927716138318623895010788866272024264"),n("21584395482704209334823622290379665147239961968378104390343953940207365798982")),t[10]=new y(n("2203960485148121921418603742825762020974279258880205651967"),n.zero),t[11]=new y(n("18566938241244942414004596690298913868373833782006617400804628704885040364344"),n("16165975933942742336466353786298926857552937457188450663314217659523851788715")),t}}class m{constructor(t,e,i,o){if(this.poly_coeffs=[1,0],this.degree=this.poly_coeffs.length,1===arguments.length&&(this.p=t,this.re=l,this.im=l),2===arguments.length)if(n.isInstance(e))this.p=t,this.re=e,this.im=l;else if(e instanceof r){this.p=t;let i=e;do{this.re=s.construct(this.p.bitLength(),i)}while(this.re.compareTo(this.p)>=0);do{this.im=s.construct(this.p.bitLength(),i)}while(this.im.compareTo(this.p)>=0)}4===arguments.length&&(this.p=t,o?(this.re=s.mod(e,this.p),this.im=s.mod(i,this.p)):(this.re=e,this.im=i))}zero(){return this.re.isZero()&&this.im.isZero()}one(){return 0===this.re.compareTo(o)&&this.im.isZero()}eq(t){return t instanceof m&&(this.re.equals(t.re)&&this.im.equals(t.im))}neg(){return new m(this.p,0!==s.signum(this.re)?this.p.subtract(this.re):this.re,0!==s.signum(this.im)?this.p.subtract(this.im):this.im,!1)}add(t){if(t instanceof m){if(!this.p.eq(t.p))throw new Error("Operands are in different finite fields");let e=this.re.add(t.re);e.compareTo(this.p)>=0&&(e=e.subtract(this.p));let i=this.im.add(t.im);return i.compareTo(this.p)>=0&&(i=i.subtract(this.p)),new m(this.p,e,i,!1)}if(n.isInstance(t)){let e=this.re.add(t);return e.compareTo(this.p)>=0&&(e=e.subtract(this.p)),new m(this.p,e,this.im,!1)}}subtract(t){if(t instanceof m){if(this.p!==t.p)throw new Error("Operands are in different finite fields");let e=this.re.subtract(t.re);s.signum(e)<0&&(e=e.add(this.p));let i=this.im.subtract(t.im);return s.signum(i)<0&&(i=i.add(this.p)),new m(this.p,e,i,!1)}if(n.isInstance(t)){let e=this.re.subtract(t);return e.signum()<0&&(e=e.add(this.p)),new m(this.p,e,this.im,!1)}}twice(t){let e=this.re,i=this.im;for(;t-- >0;)(e=e.shiftLeft(1)).compareTo(this.p)>=0&&(e=e.subtract(this.p)),(i=i.shiftLeft(1)).compareTo(this.p)>=0&&(i=i.subtract(this.p));return new m(this.p,e,i,!1)}halve(){return new m(this.p,(s.testBit(this.re,0)?this.re.add(this.p):this.re).shiftRight(1),(s.testBit(this.im,0)?this.im.add(this.p):this.im).shiftRight(1),!1)}divide(t){if(t instanceof m)return this.multiply(t.inverse());if(n.isInstance(t)){let e=this.re.multiply(t.modInv(this.p)),i=this.im.multiply(t.modInv(this.p));return new m(this.p,e,i,!0)}return null}inverse(){const t=this.re.multiply(this.re).add(this.im.multiply(this.im)).modInv(this.p);return new m(this.p,this.re.multiply(t),this.p.subtract(this.im).multiply(t),!0)}multiply(t){if(t instanceof m){if(this===t)return this.square();if(this.bn!==t.bn)throw new Error("Operands are in different finite fields");if(this.one()||t.zero())return t;if(this.zero()||t.one())return this;let e=this.re.multiply(t.re),i=this.im.multiply(t.im),r=this.re.add(this.im).multiply(t.re.add(t.im));return new m(this.p,e.subtract(i),r.subtract(e).subtract(i),!0)}if(n.isInstance(t))return new m(this.p,this.re.multiply(t),this.im.multiply(t),!0);if(t instanceof Number){let e=this.re.multiply(n(t.toString()));for(;s.signum(e)<0;)e=e.add(this.p);for(;e.compareTo(this.p)>=0;)e=e.subtract(this.p);let i=this.im.multiply(n(t.toString()));for(;s.signum(i)<0;)i=i.add(this.p);for(;i.compareTo(this.p)>=0;)i=i.subtract(this.p);return new m(this.p,e,i,!1)}throw new Error("Incorrect type argument")}square(){return this.zero()||this.one()?this:0===s.signum(this.im)?new m(this.p,this.re.multiply(this.re),l,!0):0===s.signum(this.re)?new m(this.p,this.im.multiply(this.im).negate(),l,!0):new m(this.p,this.re.add(this.im).multiply(this.re.subtract(this.im)),this.re.multiply(this.im).shiftLeft(1),!0)}cube(){let t=this.re.multiply(this.re),e=this.im.multiply(this.im);return new m(this.p,this.re.multiply(t.subtract(e.add(e).add(e))),this.im.multiply(t.add(t).add(t).subtract(e)),!0)}mulI(){return new m(this.p,0!==s.signum(this.im)?this.p.subtract(this.im):this.im,this.re,!1)}divideI(){return new m(this.p,this.im,0!==s.signum(this.re)?this.p.subtract(this.re):this.re,!1)}mulV(){let t=this.re.subtract(this.im);s.signum(t)<0&&(t=t.add(this.p));let e=this.re.add(this.im);return e.compareTo(this.p)>=0&&(e=e.subtract(this.p)),new m(this.p,t,e,!1)}divV(){let t=this.re.add(this.im);t.compareTo(this.p)>=0&&(t=t.subtract(this.p));let e=this.im.subtract(this.re);return s.signum(e)<0&&(e=e.add(this.p)),new m(this.p,(s.testBit(t,0)?t.add(this.p):t).shiftRight(1),(s.testBit(e,0)?e.add(this.p):e).shiftRight(1),!1)}exp(t){let e=this;s.signum(t)<0&&(t=t.neg(),e=e.inverse());let i=s.toByteArray(t);var r=new Array(16);r[0]=new m(this.p,n("1")),r[1]=e;for(var o=1;o<=7;o++)r[2*o]=r[o].square(),r[2*o+1]=r[2*o].multiply(e);for(var u=r[0],l=0;l<i.length;l++){var a=255&i[l];u=u.square().square().square().square().multiply(r[a>>>4]).square().square().square().square().multiply(r[15&a])}return u}sqrt(){if(this.zero())return this;let t=this.exp(this.p.multiply(this.p).add(h).divide(16)),e=t.square();if(e.subtract(this).zero())return t;if(e.add(this).zero())return t.mulI();e=e.mulI();const i=this.p.subtract(u).modPow(this.p.subtract(o).subtract(this.p.add(o).divide(4)),this.p),r=new m(this.p,i,this.p.subtract(i),!1);return t=t.multiply(r),e.subtract(this).zero()?t:e.add(this).zero()?t.mulI():null}cbrt(){if(this.zero())return this;let t=this.exp(bn.cbrtExponent2);return t.cube().subtract(this).zero()?t:null}toString(){return"["+this.re.toString()+","+this.im.toString()+"]"}}class v{constructor(t,e){if(this.poly_coeffs=[n(82),n.zero,n.zero,n.zero,n.zero,n.zero,n(-18),n.zero,n.zero,n.zero,n.zero,n.zero],this.degree=this.poly_coeffs.length,1===arguments.length){let e=t;this.bn=e.bn,this.v=new Array(6);for(let t=0;t<6;t++)this.v[t]=e.v[t]}if(2===arguments.length)if(n.isInstance(e)){this.bn=t,this.v=new Array(6),this.v[0]=new m(t.p,e);for(let e=1;e<6;e++)this.v[e]=new m(t.p)}else if(e instanceof Array)this.bn=t,this.v=e;else{let i=e;this.bn=t,this.v=new Array(6);for(let e=0;e<6;e++)this.v[e]=new m(t.p,i)}}zero(){return this.v[0].zero()&&this.v[1].zero()&&this.v[2].zero()&&this.v[3].zero()&&this.v[4].zero()&&this.v[5].zero()}one(){return this.v[0].one()&&this.v[1].zero()&&this.v[2].zero()&&this.v[3].zero()&&this.v[4].zero()&&this.v[5].zero()}eq(t){return t instanceof v&&(this.v[0].eq(t.v[0])&&this.v[1].eq(t.v[1])&&this.v[2].eq(t.v[2])&&this.v[3].eq(t.v[3])&&this.v[4].eq(t.v[4])&&this.v[5].eq(t.v[5]))}neg(){let t=new Array(6);for(let e=0;e<6;e++)t[e]=this.v[e].neg();return new v(this.bn,t)}add(t){if(this.bn.p!==t.bn.p)throw new Error("Operands are in different finite fields");let e=new Array(6);for(let i=0;i<6;i++)e[i]=this.v[i].add(t.v[i]);return new v(this.bn,e)}subtract(t){if(this.bn.p!==t.bn.p)throw new Error("Operands are in different finite fields");let e=new Array(6);for(let i=0;i<6;i++)e[i]=this.v[i].subtract(t.v[i]);return new v(this.bn,e)}divide(t){if(n.isInstance(t)||t instanceof m){let e=new Array(6);for(let i=0;i<6;i++)e[i]=this.v[i].divide(t);return new v(this.bn,e)}if(t instanceof v)return this.multiply(t.inverse())}split(){this.s=[new m(this.bn.p,this.v[0].re),new m(this.bn.p,this.v[0].im),new m(this.bn.p,this.v[1].re),new m(this.bn.p,this.v[1].im),new m(this.bn.p,this.v[2].re),new m(this.bn.p,this.v[2].im),new m(this.bn.p,this.v[3].re),new m(this.bn.p,this.v[3].im),new m(this.bn.p,this.v[4].re),new m(this.bn.p,this.v[4].im),new m(this.bn.p,this.v[5].re),new m(this.bn.p,this.v[5].im)]}join(t){let e=new Array(6);for(let i=0;i<e.length;i++)e[i]=new m(this.bn.p,t[2*i].re,t[2*i+1].re,!1);return new v(this.bn,e)}multiply(t){if(n.isInstance(t)||t instanceof m){let e=new Array(6);for(let i=0;i<6;i++)e[i]=this.v[i].multiply(t);return new v(this.bn,e)}if(t instanceof v){if(!this.bn.p.equals(t.bn.p))throw new Error("Operands are in different finite fields");if(this.one()||t.zero())return t;if(this.zero()||t.one())return this;let e,i,r=new Array(2*this.degree-1).fill(new m(this.bn.p,l));this.split(),t.split();for(let e=0;e<this.degree;e++)for(let i=0;i<this.degree;i++)r[e+i]=r[e+i].add(this.s[e].multiply(t.s[i]));for(;r.length>this.degree;){e=r.length-this.degree-1,i=r.pop();for(let t=0;t<this.degree;t++)r[e+t]=r[e+t].subtract(i.multiply(this.poly_coeffs[t]))}return this.join(r)}}mulV(){let t=new Array(6);return t[0]=this.v[4].mulV(),t[1]=this.v[5].mulV(),t[2]=this.v[0],t[3]=this.v[1],t[4]=this.v[2],t[5]=this.v[3],new v(this.bn,t)}divV(){let t=new Array(6);return t[0]=this.v[4].divV(),t[1]=this.v[5].divV(),t[2]=this.v[0],t[3]=this.v[1],t[4]=this.v[2],t[5]=this.v[3],new v(this.bn,t)}inverse(){const t=t=>{let e=t.length-1;for(;t[e].eq(new m(this.bn.p,l))&&e>0;)e-=1;return e},e=(e,i)=>{let r=t(e),n=t(i),s=e.slice(),o=new Array(e.length).fill(new m(this.bn.p,l));for(let t=r-n;t>-1;t--){o[t]=o[t].add(s[n+t].divide(i[n]));for(let e=0;e<n+1;e++)s[e+t]=s[e+t].subtract(o[e])}return o.slice(0,t(o)+1)};let i=new Array(this.degree+1).fill(new m(this.bn.p,l));i[0]=new m(this.bn.p,o);let r=new Array(this.degree+1).fill(new m(this.bn.p,l));this.split();let n=this.s.slice();n.push(new m(this.bn.p,l));let s,u,a,h=this.poly_coeffs.map(t=>new m(this.bn.p,t)).slice();for(h.push(new m(this.bn.p,o));t(n);){s=(s=e(h,n)).concat(new Array(this.degree+1-s.length).fill(new m(this.bn.p,l))),u=r.slice(),a=h.slice();for(let t=0;t<this.degree+1;t++)for(let e=0;e<this.degree+1-t;e++)u[t+e]=u[t+e].subtract(i[t].multiply(s[e])),a[t+e]=a[t+e].subtract(n[t].multiply(s[e]));let t=u.slice(),o=a.slice(),p=i.slice(),c=n.slice();i=t,n=o,r=p,h=c}return this.join(i.slice(0,this.degree)).divide(n[0].re)}exp(t){let e=this;for(let i=t.bitLength()-2;i>=0;i--)e=e.multiply(e),s.testBit(t,i)&&(e=e.multiply(this));return e}finExp(){return this.exp(this.bn.p.pow(12).subtract(o).divide(this.bn.n))}toString(){return"["+this.v[0].re.toString()+", "+this.v[0].im.toString()+", "+this.v[1].re.toString()+", "+this.v[1].im.toString()+", "+this.v[2].re.toString()+", "+this.v[2].im.toString()+", "+this.v[3].re.toString()+", "+this.v[3].im.toString()+", "+this.v[4].re.toString()+", "+this.v[4].im.toString()+", "+this.v[5].re.toString()+", "+this.v[5].im.toString()+"]"}}t.exports={Field:c,Fp2:y,Fp6:d,Fp12:f,Field2:m,Field12:v,Parameters:p}},function(t,e,i){"use strict";const r=i(7);t.exports=class{nextBytes(t){if(t.length)for(let e=0;e<t.length;++e)t[e]=r.randomBytes(1).readUInt8(0)}}},function(t,e,i){"use strict";const{Curve:r,Curve2:n}=i(8),{Field2:s,Field12:o}=i(2),u=i(0),l=i(1);class a{constructor(t,e,i){if(this.preComp=null,1===arguments.length&&(t instanceof r&&(this.E=t,this.x=t.bn._1,this.y=t.bn._1,this.inf=!0),t instanceof a)){let e=t;this.E=e.E,this.x=e.x,this.y=e.y,this.inf=e.inf}if(3===arguments.length)if(e instanceof s&&i instanceof s)this.E=t,this.x=e,this.y=i,this.inf=!1;else if(u.isInstance(e)){let r=i;this.E=t;let n=t.bn.p;if(this.x=l.mod(e,n),0===e.signum())throw new Error("The given point does not belong to the given elliptic curve");if(this.y=t.bn.sqrt(new l(e.multiply(e).multiply(e).add(t.b)).mod(n)),null===this.y)throw new Error("The given point does not belong to the given elliptic curve");l.testBit(this.y,0)!==(1==(1&r))&&(this.y=n.subtract(i))}else if(u.isInstance(i)){let r=e;this.E=t;let n=t.bn.p;if(this.y=l.mod(i,n),0===i.signum())throw new Error("The given point does not belong to the given elliptic curve");if(this.x=t.bn.cbrt(new l(i.multiply(i).subtract(t.b)).mod(n)),null===this.x)throw new Error("The given point does not belong to the given elliptic curve");if(this.x.mod(t.bn._3).intValue()!==r){let i=t.bn.zeta;if(this.x=new l(i.multiply(e)).mod(n),this.x.mod(t.bn._3).intValue()!==r&&(this.x=new l(i.multiply(e)).mod(n),this.x.mod(t.bn._3).intValue()!==r))throw new Error("The given point does not belong to the given elliptic curve")}}u.isInstance(this.x)&&(this.x=new s(t.bn.p,this.x)),u.isInstance(this.y)&&(this.y=new s(t.bn.p,this.y))}toString(){return"("+this.x.toString()+","+this.y.toString()+")"}zero(){return this.inf}eq(t){return!!(t instanceof a&&this.same(t))&&(this.x.eq(t.x)&&this.y.eq(t.y))}same(t){return this.E.bn===t.E.bn}neg(){return this.y.zero()?new a(this.E,this.x,this.y):new a(this.E,this.x,this.y.neg())}add(t){if(this.zero())return t;if(t.zero())return this;const e=u("2"),i=this.x,r=this.y,n=t.x,s=t.y;let o;if(i.eq(n)&&r.eq(s))return this.double(t);if(i.eq(n))return this.E.infinity;let l=(o=s.subtract(r).divide(n.subtract(i))).exp(e).subtract(i).subtract(n),h=o.neg().multiply(l).add(o.multiply(i)).subtract(r);return new a(this.E,l,h)}subtract(t){return this.add(t.neg())}double(){let t=this.x,e=this.y;const i=new s(this.E.bn.p,u(2));let r=new s(this.E.bn.p,u(3)).multiply(t).multiply(t).divide(i.multiply(e)),n=r.exp(u(2)).subtract(i.multiply(t)),o=r.neg().multiply(n).add(r.multiply(t)).subtract(e);return new a(this.E,n,o)}twice(t){if(this.zero())return this;let e=new a(this.E,this.x,this.y);for(let i=0;i<t;i++)e=e.double();return e}multiply(t){if(t.isZero())return this.E.infinity;if(t.equals(1))return this;if(t.mod(2).isZero()){return this.double().multiply(t.divide(2))}return this.add(this.double().multiply(t.divide(2)))}toF12(){if(this.eq(this.E.infinity))return this.E.infinity;let t=this.x,e=this.y,i=new o(this.E.bn,[new s(this.E.bn.p,t.re,u.zero,!1),new s(this.E.bn.p,u.zero,u.zero,!1),new s(this.E.bn.p,u.zero,u.zero,!1),new s(this.E.bn.p,u.zero,u.zero,!1),new s(this.E.bn.p,u.zero,u.zero,!1),new s(this.E.bn.p,u.zero,u.zero,!1)]),r=new o(this.E.bn,[new s(this.E.bn.p,e.re,u.zero,!1),new s(this.E.bn.p,u.zero,u.zero,!1),new s(this.E.bn.p,u.zero,u.zero,!1),new s(this.E.bn.p,u.zero,u.zero,!1),new s(this.E.bn.p,u.zero,u.zero,!1),new s(this.E.bn.p,u.zero,u.zero,!1)]);return new p(this.E,i,r)}}class h extends a{constructor(t,e,i){if(super(t,e,i),1===arguments.length&&(t instanceof n&&(this.E=t,this.x=t.Fp2_1,this.y=t.Fp2_1,this.inf=!0),t instanceof h)){let e=t;this.E=e.E,this.x=e.x,this.y=e.y,this.inf=e.inf}if(3===arguments.length&&e instanceof s&&i instanceof s&&(this.E=t,this.x=e,this.y=i,this.inf=!1,!t.contains(this)))throw new Error("pointNotOnCurve")}add(t){if(this.zero())return t;if(t.zero())return this;const e=u("2");let i,r=this.x,n=this.y,s=t.x,o=t.y;if(r.eq(s)&&n.eq(o))return this.double(t);if(r.eq(s))return this.E.infinity;let l=(i=o.subtract(n).divide(s.subtract(r))).exp(e).subtract(r).subtract(s),a=i.neg().multiply(l).add(i.multiply(r)).subtract(n);return new h(this.E,l,a)}twice(t){if(this.zero())return this;let e=new h(this.E,this.x,this.y);for(let i=0;i<t;i++)e=e.double();return e}double(){let t=this.x,e=this.y;const i=new s(this.E.bn.p,u(2));let r=new s(this.E.bn.p,u(3)).multiply(t).multiply(t).divide(i.multiply(e)),n=r.exp(u(2)).subtract(i.multiply(t)),o=r.neg().multiply(n).add(r.multiply(t)).subtract(e);return new h(this.E,n,o)}toF12(){if(this.eq(this.E.infinity))return this.E.infinity;let t=this.x,e=this.y,i=new s(this.E.bn.p,t.re),r=new s(this.E.bn.p,e.re),n=new s(this.E.bn.p,t.im),l=new s(this.E.bn.p,e.im),a=i.subtract(n.multiply(u(9))),h=r.subtract(l.multiply(u(9))),c=new o(this.E.bn,[new s(this.E.bn.p,u.zero,u.one,!1),new s(this.E.bn.p,u.zero,u.zero,!1),new s(this.E.bn.p,u.zero,u.zero,!1),new s(this.E.bn.p,u.zero,u.zero,!1),new s(this.E.bn.p,u.zero,u.zero,!1),new s(this.E.bn.p,u.zero,u.zero,!1)]),y=new o(this.E.bn,[new s(this.E.bn.p,a.re,u.zero,!1),new s(this.E.bn.p,u.zero,u.zero,!1),new s(this.E.bn.p,u.zero,u.zero,!1),new s(this.E.bn.p,t.im,u.zero,!1),new s(this.E.bn.p,u.zero,u.zero,!1),new s(this.E.bn.p,u.zero,u.zero,!1)]),d=new o(this.E.bn,[new s(this.E.bn.p,h.re,u.zero,!1),new s(this.E.bn.p,u.zero,u.zero,!1),new s(this.E.bn.p,u.zero,u.zero,!1),new s(this.E.bn.p,e.im,u.zero,!1),new s(this.E.bn.p,u.zero,u.zero,!1),new s(this.E.bn.p,u.zero,u.zero,!1)]);return y=y.multiply(c).multiply(c),d=d.multiply(c).multiply(c).multiply(c),new p(this.E,y,d)}toString(){return"("+this.x.toString()+","+this.y.toString()+")"}}class p extends h{constructor(t,e,i){if(super(t,e,i),1===arguments.length&&(t instanceof n&&(this.E=t,this.x=t.Fp12_1,this.y=t.Fp12_1,this.inf=!0),t instanceof h)){let e=t;this.E=e.E,this.x=e.x,this.y=e.y,this.inf=e.inf}3===arguments.length&&e instanceof o&&i instanceof o&&(this.E=t,this.x=e,this.y=i,this.inf=!1)}add(t){if(this.zero())return t;if(t.zero())return this;u("2");let e,i=this.x,r=this.y,n=t.x,s=t.y;if(i.eq(n)&&r.eq(s))return this.double(t);if(i.eq(n))return this.E.infinity;let o=(e=s.subtract(r).divide(n.subtract(i))).multiply(e).subtract(i).subtract(n),l=e.neg().multiply(o).add(e.multiply(i)).subtract(r);return new p(this.E,o,l)}twice(t){if(this.zero())return this;let e=new p(this.E,this.x,this.y);for(let i=0;i<t;i++)e=e.double();return e}double(){let t=this.x,e=this.y,i=new o(this.E.bn,u(3)),r=new o(this.E.bn,u(2)),n=i.multiply(t).multiply(t).divide(r.multiply(e)),s=n.multiply(n).subtract(r.multiply(t)),l=n.neg().multiply(s).add(n.multiply(t)).subtract(e);return new p(this.E,s,l)}toString(){return"("+this.x.toString()+", "+this.y.toString()+")"}}t.exports={Point:a,Point2:h,Point12:p}},function(t,e,i){const{Field:r,Fp2:n}=i(2),s=i(0),o=i(1);class u{constructor(t,e,i){t instanceof r&&e instanceof r&&i instanceof r&&(this.x=t,this.y=e,this.z=i)}static get n(){return s("21888242871839275222246405745257275088548364400416034343698204186575808495617")}static get ZERO(){return new u(r._0,r._0,r._0)}zero(){return u.ZERO}b(){return new r(s(3))}one(){return r._1}neg(){return new u(this.x,this.y.negate(),this.z)}toAffine(){if(this.isZero())return zero=zero(),new BN128(zero.x,one(),zero.z);let t=this.z.inverse(),e=t.square(),i=e.multiply(t),r=this.x.multiply(e),n=this.y.multiply(i);return new u(r,n,this.one())}toEthNotation(){let t=this.toAffine();return t.isZero()?this.zero():t}isOnCurve(){if(this.isZero())return!0;let t=this.z.square().multiply(this.z).square(),e=this.y.square(),i=this.x.square().multiply(this.x).add(this.b().multiply(t));return e.eq(i)}add(t){if(this.isZero())return t;if(t.isZero())return this;let e=this.x,i=this.y,r=this.z,n=t.x,s=t.y,o=t.z,l=r.square(),a=o.square(),h=e.multiply(a),p=n.multiply(l),c=r.multiply(l),y=o.multiply(a),d=i.multiply(y),f=s.multiply(c);if(h.eq(p)&&d.eq(f))return this.double();let m=p.subtract(h),b=m.double().square(),v=m.multiply(b),g=f.subtract(d).double(),w=h.multiply(b),E=r.add(o).square().subtract(r.square()).subtract(o.square()),q=g.square().subtract(v).subtract(w.double()),z=w.subtract(q).multiply(g).subtract(d.multiply(v).double()),S=E.multiply(m);return new u(q,z,S)}multiply(t){if(!s.isInstance(t))throw new Error("error not bigint");if(0==t.compareTo(s.zero))return this.zero();if(this.isZero())return this;let e=this.zero();for(let i=t.bitLength()-1;i>=0;i--)e=e.double(),o.testBit(t,i)&&(e=e.add(this));return e}double(){if(this.isZero())return this;let t=this.x.square(),e=this.y.square(),i=e.square(),r=this.x.add(e).square().subtract(t).subtract(i);r=r.add(r);let n=t.add(t).add(t),s=n.square().subtract(r.add(r)),o=n.multiply(r.subtract(s)).subtract(i.double().double().double()),l=this.y.multiply(this.z).double();return new u(s,o,l)}isZero(){return this.z.isZero()}isValid(){return!(!this.x instanceof r||!this.y instanceof r||!this.z instanceof r)&&!!this.isOnCurve()}toString(){return this.x.toString(),this.y.toString(),this.z.toString()}eq(t){if(this==t)return!0;if(!(t instanceof u))return!1;let e=t;return!(null!=this.x?!this.x.eq(e.x):null!=e.x)&&(!(null!=this.y?!this.y.eq(e.y):null!=e.y)&&!(null!=this.z?!this.z.eq(e.z):null!=e.z))}static create(t,e){let i=new r(t),n=new r(e);if(i.isZero()&&n.isZero())return BN128.ZERO;let s=new u(i,n,r._1);return s.isValid()?s:null}toString(){return this.x.toString()+" "+this.y.toString()+" "+this.z.toString()}}class l{constructor(t,e,i){t instanceof n&&e instanceof n&&i instanceof n&&(this.x=t,this.y=e,this.z=i)}static get n(){return s("21888242871839275222246405745257275088548364400416034343698204186575808495617")}static get TWIST_MUL_BY_P_X(){return new n(s("21575463638280843010398324269430826099269044274347216827212613867836435027261"),s("10307601595873709700152284273816112264069230130616436755625194854815875713954"))}static get TWIST_MUL_BY_P_Y(){return new n(s("2821565182194536844548159561693502659359617185244120367078079554186484126554"),s("3505843767911556378687030309984248845540243509899259641013678093033130930403"))}static get ZERO(){return new l(n._0,n._0,n._0)}zero(){return l.ZERO}static get TWIST(){return new n(s(9),s(1))}b(){let t=l.TWIST.inverse();return new n(t.a.multiply(new r(s(3))),t.b.multiply(new r(s(3))))}one(){return n._1}toAffine(){if(this.isZero())return zero=zero(),new l(zero.x,one(),zero.z);let t=this.z.inverse(),e=t.square(),i=e.multiply(t),r=this.x.multiply(e),n=this.y.multiply(i);return new l(r,n,this.one())}toEthNotation(){let t=this.toAffine();return t.isZero()?this.zero():t}isOnCurve(){if(this.isZero())return!0;let t=this.z.square().multiply(this.z).square(),e=this.y.square(),i=this.x.square().multiply(this.x).add(this.b().multiply(t));return e.eq(i)}add(t){if(this.isZero())return t;if(t.isZero())return this;let e=this.x,i=this.y,r=this.z,n=t.x,s=t.y,o=t.z,u=r.square(),a=o.square(),h=e.multiply(a),p=n.multiply(u),c=r.multiply(u),y=o.multiply(a),d=i.multiply(y),f=s.multiply(c);if(h.eq(p)&&d.eq(f))return this.double();let m=p.subtract(h),b=m.double().square(),v=m.multiply(b),g=f.subtract(d).double(),w=h.multiply(b),E=r.add(o).square().subtract(r.square()).subtract(o.square()),q=g.square().subtract(v).subtract(w.double()),z=w.subtract(q).multiply(g).subtract(d.multiply(v).double()),S=E.multiply(m);return new l(q,z,S)}multiply(t){if(!s.isInstance(t))throw new Error("error not bigint");if(0==t.compareTo(s.zero))return this.zero();if(this.isZero())return this;let e=this.zero();for(let i=t.bitLength()-1;i>=0;i--)e=e.double(),o.testBit(t,i)&&(e=e.add(this));return e}double(){if(this.isZero())return this;let t=this.x.square(),e=this.y.square(),i=e.square(),r=this.x.add(e).square().subtract(t).subtract(i);r=r.add(r);let n=t.add(t).add(t),s=n.square().subtract(r.add(r)),o=n.multiply(r.subtract(s)).subtract(i.double().double().double()),u=this.y.multiply(this.z).double();return new l(s,o,u)}isZero(){return this.z.isZero()}isValid(){return!(!this.x instanceof n||!this.y instanceof n||!this.z instanceof n)&&!!this.isOnCurve()}toString(){return"["+this.x.toString()+", "+this.y.toString()+", "+this.z.toString()+"]"}eq(t){if(this==t)return!0;if(!(t instanceof l))return!1;let e=t;return!(null!=this.x?!this.x.eq(e.x):null!=e.x)&&(!(null!=this.y?!this.y.eq(e.y):null!=e.y)&&!(null!=this.z?!this.z.eq(e.z):null!=e.z))}static create(t,e,i,s){let o=new n(new r(t),new r(e)),u=new n(new r(i),new r(s));if(o.isZero()&&u.isZero())return l.ZERO;let a=new l(o,u,n._1);return a.isValid()?a:null}mulByP(){let t=l.TWIST_MUL_BY_P_X.multiply(this.x.frobeniusMap(s("1"))),e=l.TWIST_MUL_BY_P_Y.multiply(this.y.frobeniusMap(s("1"))),i=this.z.frobeniusMap(s("1"));return new l(t,e,i)}}t.exports={BN128Fp:u,BN128Fp2:l}},function(t,e,i){const r=i(3),{Point2:n}=i(4),s=i(0),{Parameters:o}=i(2),{BN128Fp:u,BN128Fp2:l}=i(5),{PairingCheck:a}=i(10),h=i(1);class p{constructor(t){if(this.rng=new r,t)this.s=s(t);else{let t=new Array(2);this.rng.nextBytes(t),this.s=s(t[0])}}toString(){return this.s.toString()}getPublicKey(){let t=new y;return t.init(this.s),t}sign(t){let e=new c;return e.sH=t.multiply(this.s),this.id&&(e.id=this.id),e}getMasterSecretKey(t){if(t<=1)throw Error("bad k "+t);let e=new Array(t);e[0]=this;for(let i=1;i<t;i++)e[i]=new p;return e}share(t,e){let i=this.getMasterSecretKey(e),r=new Array(t),n=new Array(t);for(let e=0;e<t;e++){let t=e+1;n[e]=t,r[e]=new p,r[e].s=d.eval(i,t),r[e].id=t}return r}recover(t){let e=d.lagrange(t);this.s=e,this.id=0}}class c{recover(t,e){return this.sH=d.lagrange(t,e),this}toString(){return this.sH.toString()}}class y{constructor(t,e){this.sQ=e.multiply(t.s)}toString(){return this.sQ.toString()}}class d{static init(t,e){if(e<2)throw Error("bad k "+e);this.c=new Array(e),this.c[0]=t;for(let t=1;t<this.c.length;t++){let e=new Array(2);rng.nextBytes(e),this.c[t]=s(e[0])}}static eval(t,e){let i=s.zero;for(let r=0;r<t.length;r++)i=i.add(t[r].s.multiply(e**r));return i}static calcDelta(t){let e=t.length;if(e<2)throw Error("bad size"+e);let i=new Array(e),r=s(t[0]);for(let i=1;i<e;i++)r=r.multiply(s(t[i]));for(let n=0;n<e;n++){let o=s(t[n]);for(let i=0;i<e;i++)if(i!=n){let e=s(t[i]).subtract(t[n]);if(0==e)throw Error("S has same id"+n+" "+i);o=o.multiply(e)}i[n]=r.divide(o)}return i}static lagrange(t,e){let i=new Array(t.length);for(let e=0;e<t.length;e++)i[e]=t[e].id;let r,o=d.calcDelta(i);r=t[0].s?s.zero:new n(e);for(let e=0;e<o.length;e++)r=t[e].s?r.add(t[e].s.multiply(o[e])):r.add(t[e].sH.multiply(o[e]));return r}}t.exports={BLSSigner:class{constructor(t){this.rng=new r,this.G=u.create(s("1"),s("2")),this.G2=l.create(s("10857046999023057135944570762232829481370756359578518086990519993285655852781"),s("11559732032986387107991004021392285783925812861821192530917403151452391805634"),s("8495653923123431417604973247489272438418190587263600148770280649306958101930"),s("4082367875863433681332203403145435568316851327593401208105741076214120093531"))}getRandomPointOnE(){if(this.rng instanceof r)return this.getG().multiply(h.construct(2*o.p.bitLength()));throw new Error("Parameter is not a cryptographically strong PRNG")}getRandomPointOnEt(){if(this.rng instanceof r)return this.getG2().multiply(h.construct(2*o.p.bitLength()));throw new Error("Parameter is not a cryptographically strong PRNG")}getG(){return this.G}getG2(){return this.G2}getPairing(){return this.pair}getParameters(){return this.bn}sign(t,e){return t.multiply(e)}verify(t,e,i,r){let n=a.create();n.addPair(i.sQ,e),n.run();let s=n.result();(n=a.create()).addPair(t,r.sH),n.run();let o=n.result();return s.eq(o)}},BLSSecretKey:p,BLSSignature:c,BLSPublicKey:y,BLSPolynomial:d,bigInt:s}},function(t,e){t.exports=require("crypto")},function(t,e,i){"use strict";const{Point:r,Point2:n}=i(4),{Field2:s,Field12:o}=i(2),u=i(3),l=i(0),a=i(1);class h{constructor(t){const e=new s(t.p,l(1)),i=new s(t.p,l(2)),n=new s(t.p,l(3));this.bn=t,this.b=n,this.infinity=new r(this),this.G=new r(this,e,i)}pointFactory(t){if(t instanceof u)return this.G.multiply(a.construct(2*this.bn.p.bitLength()));throw new Error("Parameter is not a cryptographically strong PRNG")}contains(t){if(t.E!==this)return!1;let e=t.x,i=t.y;if(e instanceof o&&i instanceof o){const t=new o(this.bn,[new s(this.bn.p,l("3"),l.zero,!1),new s(this.bn.p,l.zero,l.zero,!1),new s(this.bn.p,l.zero,l.zero,!1),new s(this.bn.p,l.zero,l.zero,!1),new s(this.bn.p,l.zero,l.zero,!1),new s(this.bn.p,l.zero,l.zero,!1)]);return i.square().eq(e.multiply(e).multiply(e).add(t))}return i.square().eq(e.multiply(e).multiply(e).add(this.b))}kG(t){return this.Gt.multiply(t)}}t.exports={Curve:h,Curve2:class extends h{constructor(t){super(t.bn),t instanceof h&&(this.E=t,this.bn=t.bn,this.Fp2_0=t.bn.Fp2_0,this.Fp2_1=t.bn.Fp2_1,this.Fp2_i=t.bn.Fp2_i,this.infinity=new n(this),this.b=new s(t.bn.p,l("3")).mulV(),256==t.bn.m&&(this.b=new s(t.bn.p,l("3")).divide(new s(t.bn.p,l("9"),l("1"),!1))),this.xt=new s(t.bn.p,l("1"),l.zero,!1),this.yt=this.xt.cube().add(this.b).sqrt(),256==t.bn.m&&(this.xt=new s(t.bn.p,l("10857046999023057135944570762232829481370756359578518086990519993285655852781"),l("11559732032986387107991004021392285783925812861821192530917403151452391805634"),!1),this.yt=new s(t.bn.p,l("8495653923123431417604973247489272438418190587263600148770280649306958101930"),l("4082367875863433681332203403145435568316851327593401208105741076214120093531"),!1)),this.Gt=new n(this,this.xt,this.yt))}pointFactory(t){if(t instanceof u)return this.Gt.multiply(a.construct(2*this.bn.p.bitLength()));throw new Error("Parameter is not a cryptographically strong PRNG")}}}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,i){const{Field:r,Fp2:n,Fp12:s}=i(2),o=i(0),u=i(1),{BN128Fp2:l}=i(5);class a{constructor(t,e,i){this.ell0=t,this.ellVW=e,this.ellVV=i}}class h{static get TWIST(){return new n(o(9),o(1))}static get PAIRING_FINAL_EXPONENT_Z(){return o("4965661367192848881")}static get LOOP_COUNT(){return o("29793968203157093288")}static create(){let t=new h;return t.pairs=new Array,t.product=s._1,t}addPair(t,e){this.pairs.push([t,e])}run(){for(let t of this.pairs){let e=this.millerLoop(t[0],t[1]);e.eq(s._1)||(this.product=this.product.multiply(e))}this.product=this.finalExponentiation(this.product)}result(){return this.product}millerLoop(t,e){t=t.toAffine(),e=e.toAffine();let i=this.calcEllCoeffs(e),r=s._1,n=0;for(let e=h.LOOP_COUNT.bitLength()-2;e>=0;e--){let s=i[n++];r=(r=r.square()).mulBy024(s.ell0,t.y.multiply(s.ellVW),t.x.multiply(s.ellVV)),u.testBit(h.LOOP_COUNT,e)&&(s=i[n++],r=r.mulBy024(s.ell0,t.y.multiply(s.ellVW),t.x.multiply(s.ellVV)))}let o=i[n++];return r=r.mulBy024(o.ell0,t.y.multiply(o.ellVW),t.x.multiply(o.ellVV)),o=i[n],r=r.mulBy024(o.ell0,t.y.multiply(o.ellVW),t.x.multiply(o.ellVV))}calcEllCoeffs(t){let e=new Array,i=t;for(let r=h.LOOP_COUNT.bitLength()-2;r>=0;r--){let n=this.flippedMillerLoopDoubling(i);if(i=n.g2,e.push(n.coeffs),u.testBit(h.LOOP_COUNT,r)){let r=this.flippedMillerLoopMixedAddition(t,i);i=r.g2,e.push(r.coeffs)}}let r=t.mulByP(),n=r.mulByP();n=new l(n.x,n.y.negate(),n.z);let s=this.flippedMillerLoopMixedAddition(r,i);return i=s.g2,e.push(s.coeffs),s=this.flippedMillerLoopMixedAddition(n,i),e.push(s.coeffs),e}flippedMillerLoopMixedAddition(t,e){let i=e.x,r=e.y,n=e.z,s=t.x,o=t.y,u=i.subtract(s.multiply(n)),p=r.subtract(o.multiply(n)),c=u.square(),y=p.square(),d=u.multiply(c),f=i.multiply(c),m=d.add(n.multiply(y)).subtract(f.double()),b=u.multiply(m),v=p.multiply(f.subtract(m)).subtract(d.multiply(r)),g=n.multiply(d),w=h.TWIST.multiply(p.multiply(s).subtract(u.multiply(o))),E=p.negate(),q=u;return{g2:new l(b,v,g),coeffs:new a(w,q,E)}}flippedMillerLoopDoubling(t){let e=t.x,i=t.y,s=t.z,u=e.multiply(i),p=new n(u.a.multiply(r._2_INV),u.b.multiply(r._2_INV)),c=i.square(),y=s.square(),d=y.add(y).add(y),f=h.TWIST.inverse(),m=new n(f.a.multiply(new r(o(3))),f.b.multiply(new r(o(3)))).multiply(d),b=m.add(m).add(m),v=c.add(b),g=new n(v.a.multiply(r._2_INV),v.b.multiply(r._2_INV)),w=i.add(s).square().subtract(c.add(y)),E=m.subtract(c),q=e.square(),z=m.square(),S=p.multiply(c.subtract(b)),x=g.square().subtract(z.add(z).add(z)),_=c.multiply(w),N=h.TWIST.multiply(E),I=w.negate(),O=q.add(q).add(q);return{g2:new l(S,x,_),coeffs:new a(N,I,O)}}finalExponentiation(t){let e=new s(t.a,t.b.negate()),i=t.inverse(),r=e.multiply(i),n=r.frobeniusMap(o(2)).multiply(r),u=n.negExp(h.PAIRING_FINAL_EXPONENT_Z).cyclotomicSquared(),l=u.cyclotomicSquared().multiply(u),a=l.negExp(h.PAIRING_FINAL_EXPONENT_Z),p=a.cyclotomicSquared().negExp(h.PAIRING_FINAL_EXPONENT_Z),c=l.unitaryInverse(),y=p.unitaryInverse().multiply(a).multiply(c),d=y.multiply(u),f=y.multiply(a).multiply(n),m=d.frobeniusMap(o(1)).multiply(f),b=y.frobeniusMap(o(2)).multiply(m);return n.unitaryInverse().multiply(d).frobeniusMap(o(3)).multiply(b)}}t.exports={PairingCheck:h}}]);