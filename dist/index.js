module.exports=function(t){var e={};function i(r){if(e[r])return e[r].exports;var s=e[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(r,s,function(e){return t[e]}.bind(null,s));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=6)}([function(t,e){t.exports=require("big-integer")},function(t,e,i){const r=i(0);t.exports=class{static construct(t,e){return"number"==typeof t?r.randBetween(r.zero,r(2).pow(t)):("string"==typeof t?("number"==typeof e&&(this.n=r(t,e)),this.n=r(t)):this.n=t,this.n)}static mod(t,e){return t<0?t.mod(e).add(e):t.mod(e)}static toByteArray(t){let e=t.toArray(256).value;for(let t in e)e[t]>128&&(e[t]=-256+e[t]);return e}static signum(t){return t.isZero()?0:t.isNegative()?-1:1}static testBit(t,e){return!t.and(r.one.shiftLeft(e)).isZero()}}},function(t,e,i){"use strict";const r=i(3),s=i(0),n=i(1),l=s("1"),u=s("2"),h=s("0"),o=s("7");class p{static get p(){return s("21888242871839275222246405745257275088696311157297823662689037894645226208583")}static get n(){return s("21888242871839275222246405745257275088548364400416034343698204186575808495617")}}class d{static get _0(){return new d(s.zero)}static get _1(){return new d(s.one)}static get NON_RESIDUE(){return new d(s("21888242871839275222246405745257275088696311157297823662689037894645226208582"))}static get _2_INV(){return new d(s("10944121435919637611123202872628637544348155578648911831344518947322613104292"))}constructor(t){this.v=t}add(t){return new d(n.mod(this.v.add(t.v),p.p))}multiply(t){return t instanceof c?new c(t.a.multiply(this),t.b.multiply(this)):new d(n.mod(this.v.multiply(t.v),p.p))}subtract(t){return new d(n.mod(this.v.subtract(t.v),p.p))}square(){return new d(n.mod(this.v.multiply(this.v),p.p))}double(){return new d(n.mod(this.v.add(this.v),p.p))}inverse(){return new d(this.v.modInv(p.p))}divide(t){let e=t.inverse();return new d(n.mod(this.v.multiply(e.v),p.p))}negate(){return new d(this.v.negate().mod(p.p))}isZero(){return 0==this.v.compareTo(s.zero)}exp(t){let e=this;for(let i=t.bitLength()-2;i>=0;i--)e=e.square(),n.testBit(t,i)&&(e=e.multiply(this));return e}bytes(){return n.toByteArray(this.v)}eq(t){return 0==this.v.compareTo(t.v)}toString(){return this.v.toString()}}class c{static get _0(){return new c(d._0,d._0)}static get _1(){return new c(d._1,d._0)}static get NON_RESIDUE(){return new c(s(9),s.one)}static get FROBENIUS_COEFFS_B(){let t=new Array(2);return t[0]=new d(s.one),t[1]=new d(s("21888242871839275222246405745257275088696311157297823662689037894645226208582")),t}constructor(t,e){t instanceof d&&e instanceof d&&(this.a=t,this.b=e),s.isInstance(t)&&s.isInstance(e)&&(this.a=new d(t),this.b=new d(e))}square(){let t=this.a.multiply(this.b),e=this.a.add(this.b).multiply(this.b.multiply(d.NON_RESIDUE).add(this.a)).subtract(t).subtract(t.multiply(d.NON_RESIDUE)),i=t.double();return new c(e,i)}multiply(t){let e=this.a.multiply(t.a),i=this.b.multiply(t.b),r=i.multiply(d.NON_RESIDUE).add(e),s=this.a.add(this.b).multiply(t.a.add(t.b)).subtract(e).subtract(i);return new c(r,s)}divide(t){let e=t.inverse();return this.multiply(e)}add(t){return new c(this.a.add(t.a),this.b.add(t.b))}subtract(t){return new c(this.a.subtract(t.a),this.b.subtract(t.b))}double(){return this.add(this)}inverse(){let t=this.a.square(),e=this.b.square(),i=t.subtract(d.NON_RESIDUE.multiply(e)).inverse(),r=this.a.multiply(i),s=this.b.multiply(i).negate();return new c(r,s)}negate(){return new c(this.a.negate(),this.b.negate())}isZero(){return this.eq(c._0)}eq(t){if(!t instanceof c)return!1;let e=t;return!(null!=this.a?!this.a.eq(e.a):null!=e.a)&&!(null!=this.b?!this.b.eq(e.b):null!=e.b)}frobeniusMap(t){let e=this.a,i=c.FROBENIUS_COEFFS_B[t.mod(s(2))].multiply(this.b);return new c(e,i)}mulByNonResidue(){return c.NON_RESIDUE.multiply(this)}exp(t){let e=this;for(let i=t.bitLength()-2;i>=0;i--)e=e.square(),n.testBit(t,i)&&(e=e.multiply(this));return e}toString(){return this.a.toString()+", "+this.b.toString()}}class y{static get _0(){return new y(c._0,c._0,c._0)}static get _1(){return new y(c._1,c._0,c._0)}static get NON_RESIDUE(){return new c(s(9),s.one)}constructor(t,e,i){this.a=t,this.b=e,this.c=i}toString(){return"["+this.a.toString()+", "+this.b.toString()+", "+this.c.toString()+"]"}square(){let t=this.a.square(),e=this.a.multiply(this.b).double(),i=this.a.subtract(this.b).add(this.c).square(),r=this.b.multiply(this.c).double(),s=this.c.square(),n=t.add(r.mulByNonResidue()),l=e.add(s.mulByNonResidue()),u=e.add(i).add(r).subtract(t).subtract(s);return new y(n,l,u)}double(){return this.add(this)}multiply(t){if(t instanceof y){let e=this.a,i=this.b,r=this.c,s=t.a,n=t.b,l=t.c,u=e.multiply(s),h=i.multiply(n),a=r.multiply(l),o=u.add(i.add(r).multiply(n.add(l)).subtract(h).subtract(a).mulByNonResidue()),p=e.add(i).multiply(s.add(n)).subtract(u).subtract(h).add(a.mulByNonResidue()),d=e.add(r).multiply(s.add(l)).subtract(u).add(h).subtract(a);return new y(o,p,d)}if(t instanceof c){let e=this.a.multiply(t),i=this.b.multiply(t),r=this.c.multiply(t);return new y(e,i,r)}}mulByNonResidue(){let t=y.NON_RESIDUE.multiply(this.c),e=this.a,i=this.b;return new y(t,e,i)}add(t){let e=this.a.add(t.a),i=this.b.add(t.b),r=this.c.add(t.c);return new y(e,i,r)}subtract(t){let e=this.a.subtract(t.a),i=this.b.subtract(t.b),r=this.c.subtract(t.c);return new y(e,i,r)}inverse(){let t=this.a.square(),e=this.b.square(),i=this.c.square(),r=this.a.multiply(this.b),s=this.a.multiply(this.c),n=this.b.multiply(this.c),l=t.subtract(n.mulByNonResidue()),u=i.mulByNonResidue().subtract(r),h=e.subtract(s),a=this.a.multiply(l).add(this.c.multiply(u).add(this.b.multiply(h)).mulByNonResidue()).inverse(),o=a.multiply(l),p=a.multiply(u),d=a.multiply(h);return new y(o,p,d)}negate(){return new y(this.a.negate(),this.b.negate(),this.c.negate())}isZero(){return this.eq(this.ZERO)}frobeniusMap(t){let e=this.a.frobeniusMap(t),i=y.FROBENIUS_COEFFS_B()[t.mod(6).toJSNumber()].multiply(this.b.frobeniusMap(t)),r=y.FROBENIUS_COEFFS_C()[t.mod(6).toJSNumber()].multiply(this.c.frobeniusMap(t));return new y(e,i,r)}eq(t){if(!(t instanceof y))return!1;let e=t;return!(null!=this.a?!this.a.eq(e.a):null!=e.a)&&(!(null!=this.b?!this.b.eq(e.b):null!=e.b)&&!(null!=this.c?!this.c.eq(e.c):null!=e.c))}divide(t){let e=t.inverse();return this.multiply(e)}exp(t){let e=this;for(let i=t.bitLength()-2;i>=0;i--)e=e.square(),n.testBit(t,i)&&(e=e.multiply(this));return e}static FROBENIUS_COEFFS_B(){let t=[];return t.push(c._1),t.push(new c(s("21575463638280843010398324269430826099269044274347216827212613867836435027261"),s("10307601595873709700152284273816112264069230130616436755625194854815875713954"))),t.push(new c(s("21888242871839275220042445260109153167277707414472061641714758635765020556616"),s.zero)),t.push(new c(s("3772000881919853776433695186713858239009073593817195771773381919316419345261"),s("2236595495967245188281701248203181795121068902605861227855261137820944008926"))),t.push(new c(s("2203960485148121921418603742825762020974279258880205651966"),s.zero)),t.push(new c(s("18429021223477853657660792034369865839114504446431234726392080002137598044644"),s("9344045779998320333812420223237981029506012124075525679208581902008406485703"))),t}static FROBENIUS_COEFFS_C(){let t=[];return t[0]=c._1,t[1]=new c(s("2581911344467009335267311115468803099551665605076196740867805258568234346338"),s("19937756971775647987995932169929341994314640652964949448313374472400716661030")),t[2]=new c(s("2203960485148121921418603742825762020974279258880205651966"),s.zero),t[3]=new c(s("5324479202449903542726783395506214481928257762400643279780343368557297135718"),s("16208900380737693084919495127334387981393726419856888799917914180988844123039")),t[4]=new c(s("21888242871839275220042445260109153167277707414472061641714758635765020556616"),s.zero),t[5]=new c(s("13981852324922362344252311234282257507216387789820983642040889267519694726527"),s("7629828391165209371577384193250820201684255241773809077146787135900891633097")),t}}class m{static get _0(){return new m(y._0,y._0)}static get _1(){return new m(y._1,y._0)}constructor(t,e){this.a=t,this.b=e}square(){let t=this.a.multiply(this.b),e=this.a.add(this.b).multiply(this.a.add(this.b.mulByNonResidue())).subtract(t).subtract(t.mulByNonResidue()),i=t.add(t);return new m(e,i)}double(){return null}mulBy024(t,e,i){let r,s,n,l,u,h,a,o,p,d,c=this.a.a,b=this.a.b,f=this.a.c,w=this.b.a,g=this.b.b,v=this.b.c,E=t,z=i,_=e;return a=c.multiply(E),o=f.multiply(z),p=g.multiply(_),n=c.add(g),s=c.add(f),l=b.add(w).add(v),u=(d=b.multiply(z)).add(p),c=h=y.NON_RESIDUE.multiply(u).add(a),u=v.multiply(_),d=d.add(u),u=u.add(o),h=y.NON_RESIDUE.multiply(u),u=b.multiply(E),d=d.add(u),b=h=h.add(u),r=E.add(z),u=s.multiply(r).subtract(a).subtract(o),h=w.multiply(_),d=d.add(h),u=u.add(h),r=f.add(g),f=u,s=z.add(_),u=r.multiply(s).subtract(o).subtract(p),h=y.NON_RESIDUE.multiply(u),u=w.multiply(E),d=d.add(u),w=h=h.add(u),u=v.multiply(z),d=d.add(u),h=y.NON_RESIDUE.multiply(u),r=E.add(_),u=n.multiply(r).subtract(a).subtract(p),g=h=h.add(u),r=E.add(z).add(_),v=u=l.multiply(r).subtract(d),new m(new y(c,b,f),new y(w,g,v))}add(t){return new m(this.a.add(t.a),this.b.add(t.b))}divide(t){let e=t.inverse();return this.multiply(e)}multiply(t){let e=t.a,i=t.b,r=this.a,s=this.b,n=r.multiply(e),l=s.multiply(i),u=n.add(l.mulByNonResidue()),h=r.add(s).multiply(e.add(i)).subtract(n).subtract(l);return new m(u,h)}subtract(t){return new m(this.a.subtract(t.a),this.b.subtract(t.b))}inverse(){let t=this.a.square(),e=this.b.square(),i=t.subtract(e.mulByNonResidue()).inverse(),r=this.a.multiply(i),s=this.b.multiply(i).negate();return new m(r,s)}negate(){return new m(a.negate(),b.negate())}isZero(){return this.eq(m._0)}frobeniusMap(t){let e=this.a.frobeniusMap(t),i=this.b.frobeniusMap(t).multiply(m.FROBENIUS_COEFFS_B[t.mod(12)]);return new m(e,i)}cyclotomicSquared(){let t,e,i,r,s,n,l,u=this.a.a,h=this.a.b,a=this.a.c,o=this.b.a,p=this.b.b,d=this.b.c;return l=u.multiply(p),t=u.add(p).multiply(u.add(y.NON_RESIDUE.multiply(p))).subtract(l).subtract(y.NON_RESIDUE.multiply(l)),e=l.add(l),l=o.multiply(a),i=o.add(a).multiply(o.add(y.NON_RESIDUE.multiply(a))).subtract(l).subtract(y.NON_RESIDUE.multiply(l)),r=l.add(l),l=h.multiply(d),s=h.add(d).multiply(h.add(y.NON_RESIDUE.multiply(d))).subtract(l).subtract(y.NON_RESIDUE.multiply(l)),n=l.add(l),u=(u=(u=t.subtract(u)).add(u)).add(t),p=(p=(p=e.add(p)).add(p)).add(e),o=(o=(o=(l=y.NON_RESIDUE.multiply(n)).add(o)).add(o)).add(l),a=(a=(a=s.subtract(a)).add(a)).add(s),h=(h=(h=i.subtract(h)).add(h)).add(i),d=(d=(d=r.add(d)).add(d)).add(r),new m(new y(u,h,a),new y(o,p,d))}cyclotomicExp(t){let e=m._1;for(let i=t.bitLength()-1;i>=0;i--)e=e.cyclotomicSquared(),n.testBit(t,i)&&(e=e.multiply(this));return e}unitaryInverse(){let t=this.a,e=this.b.negate();return new m(t,e)}negExp(t){return this.cyclotomicExp(t).unitaryInverse()}eq(t){if(this==t)return!0;if(!(t instanceof m))return!1;let e=t;return!(null!=this.a?!this.a.eq(e.a):null!=e.a)&&!(null!=this.b?!this.b.eq(e.b):null!=e.b)}toString(){return"["+this.a.toString()+" "+this.b.toString()+"]"}static get FROBENIUS_COEFFS_B(){let t=new Array(12);return t[0]=new c(s.one,s.zero),t[1]=new c(s("8376118865763821496583973867626364092589906065868298776909617916018768340080"),s("16469823323077808223889137241176536799009286646108169935659301613961712198316")),t[2]=new c(s("21888242871839275220042445260109153167277707414472061641714758635765020556617"),s.zero),t[3]=new c(s("11697423496358154304825782922584725312912383441159505038794027105778954184319"),s("303847389135065887422783454877609941456349188919719272345083954437860409601")),t[4]=new c(s("21888242871839275220042445260109153167277707414472061641714758635765020556616"),s.zero),t[5]=new c(s("3321304630594332808241809054958361220322477375291206261884409189760185844239"),s("5722266937896532885780051958958348231143373700109372999374820235121374419868")),t[6]=new c(s("21888242871839275222246405745257275088696311157297823662689037894645226208582"),s.zero),t[7]=new c(s("13512124006075453725662431877630910996106405091429524885779419978626457868503"),s("5418419548761466998357268504080738289687024511189653727029736280683514010267")),t[8]=new c(s("2203960485148121921418603742825762020974279258880205651966"),s.zero),t[9]=new c(s("10190819375481120917420622822672549775783927716138318623895010788866272024264"),s("21584395482704209334823622290379665147239961968378104390343953940207365798982")),t[10]=new c(s("2203960485148121921418603742825762020974279258880205651967"),s.zero),t[11]=new c(s("18566938241244942414004596690298913868373833782006617400804628704885040364344"),s("16165975933942742336466353786298926857552937457188450663314217659523851788715")),t}}class f{constructor(t,e,i,l){if(this.poly_coeffs=[1,0],this.degree=this.poly_coeffs.length,1===arguments.length&&(this.p=t,this.re=h,this.im=h),2===arguments.length)if(s.isInstance(e))this.p=t,this.re=e,this.im=h;else if(e instanceof r){this.p=t;let i=e;do{this.re=n.construct(this.p.bitLength(),i)}while(this.re.compareTo(this.p)>=0);do{this.im=n.construct(this.p.bitLength(),i)}while(this.im.compareTo(this.p)>=0)}4===arguments.length&&(this.p=t,l?(this.re=n.mod(e,this.p),this.im=n.mod(i,this.p)):(this.re=e,this.im=i))}zero(){return this.re.isZero()&&this.im.isZero()}one(){return 0===this.re.compareTo(l)&&this.im.isZero()}eq(t){return t instanceof f&&(this.re.equals(t.re)&&this.im.equals(t.im))}neg(){return new f(this.p,0!==n.signum(this.re)?this.p.subtract(this.re):this.re,0!==n.signum(this.im)?this.p.subtract(this.im):this.im,!1)}add(t){if(t instanceof f){if(!this.p.eq(t.p))throw new Error("Operands are in different finite fields");let e=this.re.add(t.re);e.compareTo(this.p)>=0&&(e=e.subtract(this.p));let i=this.im.add(t.im);return i.compareTo(this.p)>=0&&(i=i.subtract(this.p)),new f(this.p,e,i,!1)}if(s.isInstance(t)){let e=this.re.add(t);return e.compareTo(this.p)>=0&&(e=e.subtract(this.p)),new f(this.p,e,this.im,!1)}}subtract(t){if(t instanceof f){if(this.p!==t.p)throw new Error("Operands are in different finite fields");let e=this.re.subtract(t.re);n.signum(e)<0&&(e=e.add(this.p));let i=this.im.subtract(t.im);return n.signum(i)<0&&(i=i.add(this.p)),new f(this.p,e,i,!1)}if(s.isInstance(t)){let e=this.re.subtract(t);return e.signum()<0&&(e=e.add(this.p)),new f(this.p,e,this.im,!1)}}twice(t){let e=this.re,i=this.im;for(;t-- >0;)(e=e.shiftLeft(1)).compareTo(this.p)>=0&&(e=e.subtract(this.p)),(i=i.shiftLeft(1)).compareTo(this.p)>=0&&(i=i.subtract(this.p));return new f(this.p,e,i,!1)}halve(){return new f(this.p,(n.testBit(this.re,0)?this.re.add(this.p):this.re).shiftRight(1),(n.testBit(this.im,0)?this.im.add(this.p):this.im).shiftRight(1),!1)}divide(t){if(t instanceof f)return this.multiply(t.inverse());if(s.isInstance(t)){let e=this.re.multiply(t.modInv(this.p)),i=this.im.multiply(t.modInv(this.p));return new f(this.p,e,i,!0)}return null}inverse(){const t=this.re.multiply(this.re).add(this.im.multiply(this.im)).modInv(this.p);return new f(this.p,this.re.multiply(t),this.p.subtract(this.im).multiply(t),!0)}multiply(t){if(t instanceof f){if(this===t)return this.square();if(this.bn!==t.bn)throw new Error("Operands are in different finite fields");if(this.one()||t.zero())return t;if(this.zero()||t.one())return this;let e=this.re.multiply(t.re),i=this.im.multiply(t.im),r=this.re.add(this.im).multiply(t.re.add(t.im));return new f(this.p,e.subtract(i),r.subtract(e).subtract(i),!0)}if(s.isInstance(t))return new f(this.p,this.re.multiply(t),this.im.multiply(t),!0);if(t instanceof Number){let e=this.re.multiply(s(t.toString()));for(;n.signum(e)<0;)e=e.add(this.p);for(;e.compareTo(this.p)>=0;)e=e.subtract(this.p);let i=this.im.multiply(s(t.toString()));for(;n.signum(i)<0;)i=i.add(this.p);for(;i.compareTo(this.p)>=0;)i=i.subtract(this.p);return new f(this.p,e,i,!1)}throw new Error("Incorrect type argument")}square(){return this.zero()||this.one()?this:0===n.signum(this.im)?new f(this.p,this.re.multiply(this.re),h,!0):0===n.signum(this.re)?new f(this.p,this.im.multiply(this.im).negate(),h,!0):new f(this.p,this.re.add(this.im).multiply(this.re.subtract(this.im)),this.re.multiply(this.im).shiftLeft(1),!0)}cube(){let t=this.re.multiply(this.re),e=this.im.multiply(this.im);return new f(this.p,this.re.multiply(t.subtract(e.add(e).add(e))),this.im.multiply(t.add(t).add(t).subtract(e)),!0)}mulI(){return new f(this.p,0!==n.signum(this.im)?this.p.subtract(this.im):this.im,this.re,!1)}divideI(){return new f(this.p,this.im,0!==n.signum(this.re)?this.p.subtract(this.re):this.re,!1)}mulV(){let t=this.re.subtract(this.im);n.signum(t)<0&&(t=t.add(this.p));let e=this.re.add(this.im);return e.compareTo(this.p)>=0&&(e=e.subtract(this.p)),new f(this.p,t,e,!1)}divV(){let t=this.re.add(this.im);t.compareTo(this.p)>=0&&(t=t.subtract(this.p));let e=this.im.subtract(this.re);return n.signum(e)<0&&(e=e.add(this.p)),new f(this.p,(n.testBit(t,0)?t.add(this.p):t).shiftRight(1),(n.testBit(e,0)?e.add(this.p):e).shiftRight(1),!1)}exp(t){let e=this;n.signum(t)<0&&(t=t.neg(),e=e.inverse());let i=n.toByteArray(t);var r=new Array(16);r[0]=new f(this.p,s("1")),r[1]=e;for(var l=1;l<=7;l++)r[2*l]=r[l].square(),r[2*l+1]=r[2*l].multiply(e);for(var u=r[0],h=0;h<i.length;h++){var a=255&i[h];u=u.square().square().square().square().multiply(r[a>>>4]).square().square().square().square().multiply(r[15&a])}return u}sqrt(){if(this.zero())return this;let t=this.exp(this.p.multiply(this.p).add(o).divide(16)),e=t.square();if(e.subtract(this).zero())return t;if(e.add(this).zero())return t.mulI();e=e.mulI();const i=this.p.subtract(u).modPow(this.p.subtract(l).subtract(this.p.add(l).divide(4)),this.p),r=new f(this.p,i,this.p.subtract(i),!1);return t=t.multiply(r),e.subtract(this).zero()?t:e.add(this).zero()?t.mulI():null}cbrt(){if(this.zero())return this;let t=this.exp(bn.cbrtExponent2);return t.cube().subtract(this).zero()?t:null}toString(){return"["+this.re.toString()+","+this.im.toString()+"]"}}class w{constructor(t,e){if(this.poly_coeffs=[s(82),s.zero,s.zero,s.zero,s.zero,s.zero,s(-18),s.zero,s.zero,s.zero,s.zero,s.zero],this.degree=this.poly_coeffs.length,1===arguments.length){let e=t;this.bn=e.bn,this.v=new Array(6);for(let t=0;t<6;t++)this.v[t]=e.v[t]}if(2===arguments.length)if(s.isInstance(e)){this.bn=t,this.v=new Array(6),this.v[0]=new f(t.p,e);for(let e=1;e<6;e++)this.v[e]=new f(t.p)}else if(e instanceof Array)this.bn=t,this.v=e;else{let i=e;this.bn=t,this.v=new Array(6);for(let e=0;e<6;e++)this.v[e]=new f(t.p,i)}}zero(){return this.v[0].zero()&&this.v[1].zero()&&this.v[2].zero()&&this.v[3].zero()&&this.v[4].zero()&&this.v[5].zero()}one(){return this.v[0].one()&&this.v[1].zero()&&this.v[2].zero()&&this.v[3].zero()&&this.v[4].zero()&&this.v[5].zero()}eq(t){return t instanceof w&&(this.v[0].eq(t.v[0])&&this.v[1].eq(t.v[1])&&this.v[2].eq(t.v[2])&&this.v[3].eq(t.v[3])&&this.v[4].eq(t.v[4])&&this.v[5].eq(t.v[5]))}neg(){let t=new Array(6);for(let e=0;e<6;e++)t[e]=this.v[e].neg();return new w(this.bn,t)}add(t){if(this.bn.p!==t.bn.p)throw new Error("Operands are in different finite fields");let e=new Array(6);for(let i=0;i<6;i++)e[i]=this.v[i].add(t.v[i]);return new w(this.bn,e)}subtract(t){if(this.bn.p!==t.bn.p)throw new Error("Operands are in different finite fields");let e=new Array(6);for(let i=0;i<6;i++)e[i]=this.v[i].subtract(t.v[i]);return new w(this.bn,e)}divide(t){if(s.isInstance(t)||t instanceof f){let e=new Array(6);for(let i=0;i<6;i++)e[i]=this.v[i].divide(t);return new w(this.bn,e)}if(t instanceof w)return this.multiply(t.inverse())}split(){this.s=[new f(this.bn.p,this.v[0].re),new f(this.bn.p,this.v[0].im),new f(this.bn.p,this.v[1].re),new f(this.bn.p,this.v[1].im),new f(this.bn.p,this.v[2].re),new f(this.bn.p,this.v[2].im),new f(this.bn.p,this.v[3].re),new f(this.bn.p,this.v[3].im),new f(this.bn.p,this.v[4].re),new f(this.bn.p,this.v[4].im),new f(this.bn.p,this.v[5].re),new f(this.bn.p,this.v[5].im)]}join(t){let e=new Array(6);for(let i=0;i<e.length;i++)e[i]=new f(this.bn.p,t[2*i].re,t[2*i+1].re,!1);return new w(this.bn,e)}multiply(t){if(s.isInstance(t)||t instanceof f){let e=new Array(6);for(let i=0;i<6;i++)e[i]=this.v[i].multiply(t);return new w(this.bn,e)}if(t instanceof w){if(!this.bn.p.equals(t.bn.p))throw new Error("Operands are in different finite fields");if(this.one()||t.zero())return t;if(this.zero()||t.one())return this;let e,i,r=new Array(2*this.degree-1).fill(new f(this.bn.p,h));this.split(),t.split();for(let e=0;e<this.degree;e++)for(let i=0;i<this.degree;i++)r[e+i]=r[e+i].add(this.s[e].multiply(t.s[i]));for(;r.length>this.degree;){e=r.length-this.degree-1,i=r.pop();for(let t=0;t<this.degree;t++)r[e+t]=r[e+t].subtract(i.multiply(this.poly_coeffs[t]))}return this.join(r)}}mulV(){let t=new Array(6);return t[0]=this.v[4].mulV(),t[1]=this.v[5].mulV(),t[2]=this.v[0],t[3]=this.v[1],t[4]=this.v[2],t[5]=this.v[3],new w(this.bn,t)}divV(){let t=new Array(6);return t[0]=this.v[4].divV(),t[1]=this.v[5].divV(),t[2]=this.v[0],t[3]=this.v[1],t[4]=this.v[2],t[5]=this.v[3],new w(this.bn,t)}inverse(){const t=t=>{let e=t.length-1;for(;t[e].eq(new f(this.bn.p,h))&&e>0;)e-=1;return e},e=(e,i)=>{let r=t(e),s=t(i),n=e.slice(),l=new Array(e.length).fill(new f(this.bn.p,h));for(let t=r-s;t>-1;t--){l[t]=l[t].add(n[s+t].divide(i[s]));for(let e=0;e<s+1;e++)n[e+t]=n[e+t].subtract(l[e])}return l.slice(0,t(l)+1)};let i=new Array(this.degree+1).fill(new f(this.bn.p,h));i[0]=new f(this.bn.p,l);let r=new Array(this.degree+1).fill(new f(this.bn.p,h));this.split();let s=this.s.slice();s.push(new f(this.bn.p,h));let n,u,a,o=this.poly_coeffs.map(t=>new f(this.bn.p,t)).slice();for(o.push(new f(this.bn.p,l));t(s);){n=(n=e(o,s)).concat(new Array(this.degree+1-n.length).fill(new f(this.bn.p,h))),u=r.slice(),a=o.slice();for(let t=0;t<this.degree+1;t++)for(let e=0;e<this.degree+1-t;e++)u[t+e]=u[t+e].subtract(i[t].multiply(n[e])),a[t+e]=a[t+e].subtract(s[t].multiply(n[e]));let t=u.slice(),l=a.slice(),p=i.slice(),d=s.slice();i=t,s=l,r=p,o=d}return this.join(i.slice(0,this.degree)).divide(s[0].re)}exp(t){let e=this;for(let i=t.bitLength()-2;i>=0;i--)e=e.multiply(e),n.testBit(t,i)&&(e=e.multiply(this));return e}finExp(){return this.exp(this.bn.p.pow(12).subtract(l).divide(this.bn.n))}toString(){return"["+this.v[0].re.toString()+", "+this.v[0].im.toString()+", "+this.v[1].re.toString()+", "+this.v[1].im.toString()+", "+this.v[2].re.toString()+", "+this.v[2].im.toString()+", "+this.v[3].re.toString()+", "+this.v[3].im.toString()+", "+this.v[4].re.toString()+", "+this.v[4].im.toString()+", "+this.v[5].re.toString()+", "+this.v[5].im.toString()+"]"}}t.exports={Field:d,Fp2:c,Fp6:y,Fp12:m,Field2:f,Field12:w,Parameters:p}},function(t,e,i){"use strict";const r=i(7);t.exports=class{nextBytes(t){if(t.length)for(let e=0;e<t.length;++e)t[e]=r.randomBytes(1).readUInt8(0)}}},function(t,e,i){"use strict";const{Curve:r,Curve2:s}=i(8),{Field2:n,Field12:l}=i(2),u=i(0),h=i(1);class a{constructor(t,e,i){if(this.preComp=null,1===arguments.length&&(t instanceof r&&(this.E=t,this.x=t.bn._1,this.y=t.bn._1,this.inf=!0),t instanceof a)){let e=t;this.E=e.E,this.x=e.x,this.y=e.y,this.inf=e.inf}if(3===arguments.length)if(e instanceof n&&i instanceof n)this.E=t,this.x=e,this.y=i,this.inf=!1;else if(u.isInstance(e)){let r=i;this.E=t;let s=t.bn.p;if(this.x=h.mod(e,s),0===e.signum())throw new Error("The given point does not belong to the given elliptic curve");if(this.y=t.bn.sqrt(new h(e.multiply(e).multiply(e).add(t.b)).mod(s)),null===this.y)throw new Error("The given point does not belong to the given elliptic curve");h.testBit(this.y,0)!==(1==(1&r))&&(this.y=s.subtract(i))}else if(u.isInstance(i)){let r=e;this.E=t;let s=t.bn.p;if(this.y=h.mod(i,s),0===i.signum())throw new Error("The given point does not belong to the given elliptic curve");if(this.x=t.bn.cbrt(new h(i.multiply(i).subtract(t.b)).mod(s)),null===this.x)throw new Error("The given point does not belong to the given elliptic curve");if(this.x.mod(t.bn._3).intValue()!==r){let i=t.bn.zeta;if(this.x=new h(i.multiply(e)).mod(s),this.x.mod(t.bn._3).intValue()!==r&&(this.x=new h(i.multiply(e)).mod(s),this.x.mod(t.bn._3).intValue()!==r))throw new Error("The given point does not belong to the given elliptic curve")}}u.isInstance(this.x)&&(this.x=new n(t.bn.p,this.x)),u.isInstance(this.y)&&(this.y=new n(t.bn.p,this.y))}toString(){return"("+this.x.toString()+","+this.y.toString()+")"}zero(){return this.inf}eq(t){return!!(t instanceof a&&this.same(t))&&(this.x.eq(t.x)&&this.y.eq(t.y))}same(t){return this.E.bn===t.E.bn}neg(){return this.y.zero()?new a(this.E,this.x,this.y):new a(this.E,this.x,this.y.neg())}add(t){if(this.zero())return t;if(t.zero())return this;const e=u("2"),i=this.x,r=this.y,s=t.x,n=t.y;let l;if(i.eq(s)&&r.eq(n))return this.double(t);if(i.eq(s))return this.E.infinity;let h=(l=n.subtract(r).divide(s.subtract(i))).exp(e).subtract(i).subtract(s),o=l.neg().multiply(h).add(l.multiply(i)).subtract(r);return new a(this.E,h,o)}subtract(t){return this.add(t.neg())}double(){let t=this.x,e=this.y;const i=new n(this.E.bn.p,u(2));let r=new n(this.E.bn.p,u(3)).multiply(t).multiply(t).divide(i.multiply(e)),s=r.exp(u(2)).subtract(i.multiply(t)),l=r.neg().multiply(s).add(r.multiply(t)).subtract(e);return new a(this.E,s,l)}twice(t){if(this.zero())return this;let e=new a(this.E,this.x,this.y);for(let i=0;i<t;i++)e=e.double();return e}multiply(t){if(t.isZero())return this.E.infinity;if(t.equals(1))return this;if(t.mod(2).isZero()){return this.double().multiply(t.divide(2))}return this.add(this.double().multiply(t.divide(2)))}toF12(){if(this.eq(this.E.infinity))return this.E.infinity;let t=this.x,e=this.y,i=new l(this.E.bn,[new n(this.E.bn.p,t.re,u.zero,!1),new n(this.E.bn.p,u.zero,u.zero,!1),new n(this.E.bn.p,u.zero,u.zero,!1),new n(this.E.bn.p,u.zero,u.zero,!1),new n(this.E.bn.p,u.zero,u.zero,!1),new n(this.E.bn.p,u.zero,u.zero,!1)]),r=new l(this.E.bn,[new n(this.E.bn.p,e.re,u.zero,!1),new n(this.E.bn.p,u.zero,u.zero,!1),new n(this.E.bn.p,u.zero,u.zero,!1),new n(this.E.bn.p,u.zero,u.zero,!1),new n(this.E.bn.p,u.zero,u.zero,!1),new n(this.E.bn.p,u.zero,u.zero,!1)]);return new p(this.E,i,r)}}class o extends a{constructor(t,e,i){if(super(t,e,i),1===arguments.length&&(t instanceof s&&(this.E=t,this.x=t.Fp2_1,this.y=t.Fp2_1,this.inf=!0),t instanceof o)){let e=t;this.E=e.E,this.x=e.x,this.y=e.y,this.inf=e.inf}if(3===arguments.length&&e instanceof n&&i instanceof n&&(this.E=t,this.x=e,this.y=i,this.inf=!1,!t.contains(this)))throw new Error("pointNotOnCurve")}add(t){if(this.zero())return t;if(t.zero())return this;const e=u("2");let i,r=this.x,s=this.y,n=t.x,l=t.y;if(r.eq(n)&&s.eq(l))return this.double(t);if(r.eq(n))return this.E.infinity;let h=(i=l.subtract(s).divide(n.subtract(r))).exp(e).subtract(r).subtract(n),a=i.neg().multiply(h).add(i.multiply(r)).subtract(s);return new o(this.E,h,a)}twice(t){if(this.zero())return this;let e=new o(this.E,this.x,this.y);for(let i=0;i<t;i++)e=e.double();return e}double(){let t=this.x,e=this.y;const i=new n(this.E.bn.p,u(2));let r=new n(this.E.bn.p,u(3)).multiply(t).multiply(t).divide(i.multiply(e)),s=r.exp(u(2)).subtract(i.multiply(t)),l=r.neg().multiply(s).add(r.multiply(t)).subtract(e);return new o(this.E,s,l)}toF12(){if(this.eq(this.E.infinity))return this.E.infinity;let t=this.x,e=this.y,i=new n(this.E.bn.p,t.re),r=new n(this.E.bn.p,e.re),s=new n(this.E.bn.p,t.im),h=new n(this.E.bn.p,e.im),a=i.subtract(s.multiply(u(9))),o=r.subtract(h.multiply(u(9))),d=new l(this.E.bn,[new n(this.E.bn.p,u.zero,u.one,!1),new n(this.E.bn.p,u.zero,u.zero,!1),new n(this.E.bn.p,u.zero,u.zero,!1),new n(this.E.bn.p,u.zero,u.zero,!1),new n(this.E.bn.p,u.zero,u.zero,!1),new n(this.E.bn.p,u.zero,u.zero,!1)]),c=new l(this.E.bn,[new n(this.E.bn.p,a.re,u.zero,!1),new n(this.E.bn.p,u.zero,u.zero,!1),new n(this.E.bn.p,u.zero,u.zero,!1),new n(this.E.bn.p,t.im,u.zero,!1),new n(this.E.bn.p,u.zero,u.zero,!1),new n(this.E.bn.p,u.zero,u.zero,!1)]),b=new l(this.E.bn,[new n(this.E.bn.p,o.re,u.zero,!1),new n(this.E.bn.p,u.zero,u.zero,!1),new n(this.E.bn.p,u.zero,u.zero,!1),new n(this.E.bn.p,e.im,u.zero,!1),new n(this.E.bn.p,u.zero,u.zero,!1),new n(this.E.bn.p,u.zero,u.zero,!1)]);return c=c.multiply(d).multiply(d),b=b.multiply(d).multiply(d).multiply(d),new p(this.E,c,b)}toString(){return"("+this.x.toString()+","+this.y.toString()+")"}}class p extends o{constructor(t,e,i){if(super(t,e,i),1===arguments.length&&(t instanceof s&&(this.E=t,this.x=t.Fp12_1,this.y=t.Fp12_1,this.inf=!0),t instanceof o)){let e=t;this.E=e.E,this.x=e.x,this.y=e.y,this.inf=e.inf}3===arguments.length&&e instanceof l&&i instanceof l&&(this.E=t,this.x=e,this.y=i,this.inf=!1)}add(t){if(this.zero())return t;if(t.zero())return this;u("2");let e,i=this.x,r=this.y,s=t.x,n=t.y;if(i.eq(s)&&r.eq(n))return this.double(t);if(i.eq(s))return this.E.infinity;let l=(e=n.subtract(r).divide(s.subtract(i))).multiply(e).subtract(i).subtract(s),h=e.neg().multiply(l).add(e.multiply(i)).subtract(r);return new p(this.E,l,h)}twice(t){if(this.zero())return this;let e=new p(this.E,this.x,this.y);for(let i=0;i<t;i++)e=e.double();return e}double(){let t=this.x,e=this.y,i=new l(this.E.bn,u(3)),r=new l(this.E.bn,u(2)),s=i.multiply(t).multiply(t).divide(r.multiply(e)),n=s.multiply(s).subtract(r.multiply(t)),h=s.neg().multiply(n).add(s.multiply(t)).subtract(e);return new p(this.E,n,h)}toString(){return"("+this.x.toString()+", "+this.y.toString()+")"}}t.exports={Point:a,Point2:o,Point12:p}},function(t,e,i){const{Field:r,Fp2:s}=i(2),n=i(0),l=i(1);class u{constructor(t,e,i){t instanceof r&&e instanceof r&&i instanceof r&&(this.x=t,this.y=e,this.z=i)}static get n(){return n("21888242871839275222246405745257275088548364400416034343698204186575808495617")}static get ZERO(){return new u(r._0,r._0,r._0)}zero(){return u.ZERO}b(){return new r(n(3))}one(){return r._1}neg(){return new u(this.x,this.y.negate(),this.z)}toAffine(){if(this.isZero())return zero=zero(),new BN128(zero.x,one(),zero.z);let t=this.z.inverse(),e=t.square(),i=e.multiply(t),r=this.x.multiply(e),s=this.y.multiply(i);return new u(r,s,this.one())}toEthNotation(){let t=this.toAffine();return t.isZero()?this.zero():t}isOnCurve(){if(this.isZero())return!0;let t=this.z.square().multiply(this.z).square(),e=this.y.square(),i=this.x.square().multiply(this.x).add(this.b().multiply(t));return e.eq(i)}add(t){if(this.isZero())return t;if(t.isZero())return this;let e=this.x,i=this.y,r=this.z,s=t.x,n=t.y,l=t.z,h=r.square(),a=l.square(),o=e.multiply(a),p=s.multiply(h),d=r.multiply(h),c=l.multiply(a),b=i.multiply(c),y=n.multiply(d);if(o.eq(p)&&b.eq(y))return this.double();let m=p.subtract(o),f=m.double().square(),w=m.multiply(f),g=y.subtract(b).double(),v=o.multiply(f),E=r.add(l).square().subtract(r.square()).subtract(l.square()),z=g.square().subtract(w).subtract(v.double()),_=v.subtract(z).multiply(g).subtract(b.multiply(w).double()),q=E.multiply(m);return new u(z,_,q)}multiply(t){if(!n.isInstance(t))throw new Error("error not bigint");if(0==t.compareTo(n.zero))return this.zero();if(this.isZero())return this;let e=this.zero();for(let i=t.bitLength()-1;i>=0;i--)e=e.double(),l.testBit(t,i)&&(e=e.add(this));return e}double(){if(this.isZero())return this;let t=this.x.square(),e=this.y.square(),i=e.square(),r=this.x.add(e).square().subtract(t).subtract(i);r=r.add(r);let s=t.add(t).add(t),n=s.square().subtract(r.add(r)),l=s.multiply(r.subtract(n)).subtract(i.double().double().double()),h=this.y.multiply(this.z).double();return new u(n,l,h)}isZero(){return this.z.isZero()}isValid(){return!(!this.x instanceof r||!this.y instanceof r||!this.z instanceof r)&&!!this.isOnCurve()}toString(){return this.x.toString(),this.y.toString(),this.z.toString()}eq(t){if(this==t)return!0;if(!(t instanceof u))return!1;let e=t;return!(null!=this.x?!this.x.eq(e.x):null!=e.x)&&(!(null!=this.y?!this.y.eq(e.y):null!=e.y)&&!(null!=this.z?!this.z.eq(e.z):null!=e.z))}static create(t,e){let i=new r(t),s=new r(e);if(i.isZero()&&s.isZero())return BN128.ZERO;let n=new u(i,s,r._1);return n.isValid()?n:null}toString(){return this.x.toString()+" "+this.y.toString()+" "+this.z.toString()}}class h{constructor(t,e,i){t instanceof s&&e instanceof s&&i instanceof s&&(this.x=t,this.y=e,this.z=i)}static get n(){return n("21888242871839275222246405745257275088548364400416034343698204186575808495617")}static get TWIST_MUL_BY_P_X(){return new s(n("21575463638280843010398324269430826099269044274347216827212613867836435027261"),n("10307601595873709700152284273816112264069230130616436755625194854815875713954"))}static get TWIST_MUL_BY_P_Y(){return new s(n("2821565182194536844548159561693502659359617185244120367078079554186484126554"),n("3505843767911556378687030309984248845540243509899259641013678093033130930403"))}static get ZERO(){return new h(s._0,s._0,s._0)}zero(){return h.ZERO}static get TWIST(){return new s(n(9),n(1))}b(){let t=h.TWIST.inverse();return new s(t.a.multiply(new r(n(3))),t.b.multiply(new r(n(3))))}one(){return s._1}toAffine(){if(this.isZero())return zero=zero(),new h(zero.x,one(),zero.z);let t=this.z.inverse(),e=t.square(),i=e.multiply(t),r=this.x.multiply(e),s=this.y.multiply(i);return new h(r,s,this.one())}toEthNotation(){let t=this.toAffine();return t.isZero()?this.zero():t}isOnCurve(){if(this.isZero())return!0;let t=this.z.square().multiply(this.z).square(),e=this.y.square(),i=this.x.square().multiply(this.x).add(this.b().multiply(t));return e.eq(i)}add(t){if(this.isZero())return t;if(t.isZero())return this;let e=this.x,i=this.y,r=this.z,s=t.x,n=t.y,l=t.z,u=r.square(),a=l.square(),o=e.multiply(a),p=s.multiply(u),d=r.multiply(u),c=l.multiply(a),b=i.multiply(c),y=n.multiply(d);if(o.eq(p)&&b.eq(y))return this.double();let m=p.subtract(o),f=m.double().square(),w=m.multiply(f),g=y.subtract(b).double(),v=o.multiply(f),E=r.add(l).square().subtract(r.square()).subtract(l.square()),z=g.square().subtract(w).subtract(v.double()),_=v.subtract(z).multiply(g).subtract(b.multiply(w).double()),q=E.multiply(m);return new h(z,_,q)}multiply(t){if(!n.isInstance(t))throw new Error("error not bigint");if(0==t.compareTo(n.zero))return this.zero();if(this.isZero())return this;let e=this.zero();for(let i=t.bitLength()-1;i>=0;i--)e=e.double(),l.testBit(t,i)&&(e=e.add(this));return e}double(){if(this.isZero())return this;let t=this.x.square(),e=this.y.square(),i=e.square(),r=this.x.add(e).square().subtract(t).subtract(i);r=r.add(r);let s=t.add(t).add(t),n=s.square().subtract(r.add(r)),l=s.multiply(r.subtract(n)).subtract(i.double().double().double()),u=this.y.multiply(this.z).double();return new h(n,l,u)}isZero(){return this.z.isZero()}isValid(){return!(!this.x instanceof s||!this.y instanceof s||!this.z instanceof s)&&!!this.isOnCurve()}toString(){return"["+this.x.toString()+", "+this.y.toString()+", "+this.z.toString()+"]"}eq(t){if(this==t)return!0;if(!(t instanceof h))return!1;let e=t;return!(null!=this.x?!this.x.eq(e.x):null!=e.x)&&(!(null!=this.y?!this.y.eq(e.y):null!=e.y)&&!(null!=this.z?!this.z.eq(e.z):null!=e.z))}static create(t,e,i,n){let l=new s(new r(t),new r(e)),u=new s(new r(i),new r(n));if(l.isZero()&&u.isZero())return h.ZERO;let a=new h(l,u,s._1);return a.isValid()?a:null}mulByP(){let t=h.TWIST_MUL_BY_P_X.multiply(this.x.frobeniusMap(n("1"))),e=h.TWIST_MUL_BY_P_Y.multiply(this.y.frobeniusMap(n("1"))),i=this.z.frobeniusMap(n("1"));return new h(t,e,i)}}t.exports={BN128Fp:u,BN128Fp2:h}},function(t,e,i){const r=i(3),{Point2:s}=i(4),n=i(0),{Parameters:l}=i(2),{BN128Fp:u,BN128Fp2:h}=i(5),{PairingCheck:a}=i(9),o=i(1);class p{constructor(t){if(this.rng=new r,t)this.s=n(t);else{let t=new Array(2);this.rng.nextBytes(t),this.s=n(t[0])}}toString(){return this.s.toString()}getPublicKey(){let t=new c;return t.init(this.s),t}sign(t){let e=new d;return e.sH=t.multiply(this.s),this.id&&(e.id=this.id),e}getMasterSecretKey(t){if(t<=1)throw Error("bad k "+t);let e=new Array(t);e[0]=this;for(let i=1;i<t;i++)e[i]=new p;return e}share(t,e){let i=this.getMasterSecretKey(e),r=new Array(t),s=new Array(t);for(let e=0;e<t;e++){let t=e+1;s[e]=t,r[e]=new p,r[e].s=b.eval(i,t),r[e].id=t}return r}recover(t){let e=b.lagrange(t);this.s=e,this.id=0}}class d{recover(t,e){return this.sH=b.lagrange(t,e),this}toString(){return this.sH.toString()}}class c{constructor(t,e){this.sQ=e.multiply(t.s)}toString(){return this.sQ.toString()}}class b{static init(t,e){if(e<2)throw Error("bad k "+e);this.c=new Array(e),this.c[0]=t;for(let t=1;t<this.c.length;t++){let e=new Array(2);rng.nextBytes(e),this.c[t]=n(e[0])}}static eval(t,e){let i=n.zero;for(let r=0;r<t.length;r++)i=i.add(t[r].s.multiply(e**r));return i}static calcDelta(t){let e=t.length;if(e<2)throw Error("bad size"+e);let i=new Array(e),r=n(t[0]);for(let i=1;i<e;i++)r=r.multiply(n(t[i]));for(let s=0;s<e;s++){let l=n(t[s]);for(let i=0;i<e;i++)if(i!=s){let e=n(t[i]).subtract(t[s]);if(0==e)throw Error("S has same id"+s+" "+i);l=l.multiply(e)}i[s]=r.divide(l)}return i}static lagrange(t,e){let i=new Array(t.length);for(let e=0;e<t.length;e++)i[e]=t[e].id;let r,l=b.calcDelta(i);r=t[0].s?n.zero:new s(e);for(let e=0;e<l.length;e++)r=t[e].s?r.add(t[e].s.multiply(l[e])):r.add(t[e].sH.multiply(l[e]));return r}}t.exports={BLSSigner:class{constructor(t){this.rng=new r,this.G=u.create(n("1"),n("2")),this.G2=h.create(n("10857046999023057135944570762232829481370756359578518086990519993285655852781"),n("11559732032986387107991004021392285783925812861821192530917403151452391805634"),n("8495653923123431417604973247489272438418190587263600148770280649306958101930"),n("4082367875863433681332203403145435568316851327593401208105741076214120093531"))}getRandomPointOnE(){if(this.rng instanceof r)return this.getG().multiply(o.construct(2*l.p.bitLength()));throw new Error("Parameter is not a cryptographically strong PRNG")}getRandomPointOnEt(){if(this.rng instanceof r)return this.getG2().multiply(o.construct(2*l.p.bitLength()));throw new Error("Parameter is not a cryptographically strong PRNG")}getG(){return this.G}getG2(){return this.G2}getPairing(){return this.pair}getParameters(){return this.bn}sign(t,e){return t.multiply(e)}verify(t,e,i,r){let s=a.create();s.addPair(i.sQ,e),s.run();let n=s.result();(s=a.create()).addPair(t,r.sH),s.run();let l=s.result();return n.eq(l)}},BLSSecretKey:p,BLSSignature:d,BLSPublicKey:c,BLSPolynomial:b}},function(t,e){t.exports=require("crypto")},function(t,e,i){"use strict";const{Point:r,Point2:s}=i(4),{Field2:n,Field12:l}=i(2),u=i(3),h=i(0),a=i(1);class o{constructor(t){const e=new n(t.p,h(1)),i=new n(t.p,h(2)),s=new n(t.p,h(3));this.bn=t,this.b=s,this.infinity=new r(this),this.G=new r(this,e,i)}pointFactory(t){if(t instanceof u)return this.G.multiply(a.construct(2*this.bn.p.bitLength()));throw new Error("Parameter is not a cryptographically strong PRNG")}contains(t){if(t.E!==this)return!1;let e=t.x,i=t.y;if(e instanceof l&&i instanceof l){const t=new l(this.bn,[new n(this.bn.p,h("3"),h.zero,!1),new n(this.bn.p,h.zero,h.zero,!1),new n(this.bn.p,h.zero,h.zero,!1),new n(this.bn.p,h.zero,h.zero,!1),new n(this.bn.p,h.zero,h.zero,!1),new n(this.bn.p,h.zero,h.zero,!1)]);return i.square().eq(e.multiply(e).multiply(e).add(t))}return i.square().eq(e.multiply(e).multiply(e).add(this.b))}kG(t){return this.Gt.multiply(t)}}t.exports={Curve:o,Curve2:class extends o{constructor(t){super(t.bn),t instanceof o&&(this.E=t,this.bn=t.bn,this.Fp2_0=t.bn.Fp2_0,this.Fp2_1=t.bn.Fp2_1,this.Fp2_i=t.bn.Fp2_i,this.infinity=new s(this),this.b=new n(t.bn.p,h("3")).mulV(),256==t.bn.m&&(this.b=new n(t.bn.p,h("3")).divide(new n(t.bn.p,h("9"),h("1"),!1))),this.xt=new n(t.bn.p,h("1"),h.zero,!1),this.yt=this.xt.cube().add(this.b).sqrt(),256==t.bn.m&&(this.xt=new n(t.bn.p,h("10857046999023057135944570762232829481370756359578518086990519993285655852781"),h("11559732032986387107991004021392285783925812861821192530917403151452391805634"),!1),this.yt=new n(t.bn.p,h("8495653923123431417604973247489272438418190587263600148770280649306958101930"),h("4082367875863433681332203403145435568316851327593401208105741076214120093531"),!1)),this.Gt=new s(this,this.xt,this.yt))}pointFactory(t){if(t instanceof u)return this.Gt.multiply(a.construct(2*this.bn.p.bitLength()));throw new Error("Parameter is not a cryptographically strong PRNG")}}}},function(t,e,i){const{Field:r,Fp2:s,Fp12:n}=i(2),l=i(0),u=i(1),{BN128Fp2:h}=i(5);class a{constructor(t,e,i){this.ell0=t,this.ellVW=e,this.ellVV=i}}class o{static get TWIST(){return new s(l(9),l(1))}static get PAIRING_FINAL_EXPONENT_Z(){return l("4965661367192848881")}static get LOOP_COUNT(){return l("29793968203157093288")}static create(){let t=new o;return t.pairs=new Array,t.product=n._1,t}addPair(t,e){this.pairs.push([t,e])}run(){for(let t of this.pairs){let e=this.millerLoop(t[0],t[1]);e.eq(n._1)||(this.product=this.product.multiply(e))}this.product=this.finalExponentiation(this.product)}result(){return this.product}millerLoop(t,e){t=t.toAffine(),e=e.toAffine();let i=this.calcEllCoeffs(e),r=n._1,s=0;for(let e=o.LOOP_COUNT.bitLength()-2;e>=0;e--){let n=i[s++];r=(r=r.square()).mulBy024(n.ell0,t.y.multiply(n.ellVW),t.x.multiply(n.ellVV)),u.testBit(o.LOOP_COUNT,e)&&(n=i[s++],r=r.mulBy024(n.ell0,t.y.multiply(n.ellVW),t.x.multiply(n.ellVV)))}let l=i[s++];return r=r.mulBy024(l.ell0,t.y.multiply(l.ellVW),t.x.multiply(l.ellVV)),l=i[s],r=r.mulBy024(l.ell0,t.y.multiply(l.ellVW),t.x.multiply(l.ellVV))}calcEllCoeffs(t){let e=new Array,i=t;for(let r=o.LOOP_COUNT.bitLength()-2;r>=0;r--){let s=this.flippedMillerLoopDoubling(i);if(i=s.g2,e.push(s.coeffs),u.testBit(o.LOOP_COUNT,r)){let r=this.flippedMillerLoopMixedAddition(t,i);i=r.g2,e.push(r.coeffs)}}let r=t.mulByP(),s=r.mulByP();s=new h(s.x,s.y.negate(),s.z);let n=this.flippedMillerLoopMixedAddition(r,i);return i=n.g2,e.push(n.coeffs),n=this.flippedMillerLoopMixedAddition(s,i),e.push(n.coeffs),e}flippedMillerLoopMixedAddition(t,e){let i=e.x,r=e.y,s=e.z,n=t.x,l=t.y,u=i.subtract(n.multiply(s)),p=r.subtract(l.multiply(s)),d=u.square(),c=p.square(),b=u.multiply(d),y=i.multiply(d),m=b.add(s.multiply(c)).subtract(y.double()),f=u.multiply(m),w=p.multiply(y.subtract(m)).subtract(b.multiply(r)),g=s.multiply(b),v=o.TWIST.multiply(p.multiply(n).subtract(u.multiply(l))),E=p.negate(),z=u;return{g2:new h(f,w,g),coeffs:new a(v,z,E)}}flippedMillerLoopDoubling(t){let e=t.x,i=t.y,n=t.z,u=e.multiply(i),p=new s(u.a.multiply(r._2_INV),u.b.multiply(r._2_INV)),d=i.square(),c=n.square(),b=c.add(c).add(c),y=o.TWIST.inverse(),m=new s(y.a.multiply(new r(l(3))),y.b.multiply(new r(l(3)))).multiply(b),f=m.add(m).add(m),w=d.add(f),g=new s(w.a.multiply(r._2_INV),w.b.multiply(r._2_INV)),v=i.add(n).square().subtract(d.add(c)),E=m.subtract(d),z=e.square(),_=m.square(),q=p.multiply(d.subtract(f)),x=g.square().subtract(_.add(_).add(_)),S=d.multiply(v),N=o.TWIST.multiply(E),I=v.negate(),O=z.add(z).add(z);return{g2:new h(q,x,S),coeffs:new a(N,I,O)}}finalExponentiation(t){let e=new n(t.a,t.b.negate()),i=t.inverse(),r=e.multiply(i),s=r.frobeniusMap(l(2)).multiply(r),u=s.negExp(o.PAIRING_FINAL_EXPONENT_Z).cyclotomicSquared(),h=u.cyclotomicSquared().multiply(u),a=h.negExp(o.PAIRING_FINAL_EXPONENT_Z),p=a.cyclotomicSquared().negExp(o.PAIRING_FINAL_EXPONENT_Z),d=h.unitaryInverse(),c=p.unitaryInverse().multiply(a).multiply(d),b=c.multiply(u),y=c.multiply(a).multiply(s),m=b.frobeniusMap(l(1)).multiply(y),f=c.frobeniusMap(l(2)).multiply(m);return s.unitaryInverse().multiply(b).frobeniusMap(l(3)).multiply(f)}}t.exports={PairingCheck:o}}]);